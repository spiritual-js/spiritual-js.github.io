!function(t){"use strict";!function(){function i(t,i){Object.keys(i).forEach(function(e){var n=i[e];void 0===t[e]&&(n.get&&n.set||(t[e]=n))})}function e(){i(String.prototype,{trim:function(){return this.trimLeft().trimRight()},trimRight:function(){return this.replace(/\s+$/,"")},trimLeft:function(){return this.replace(/^\s*/,"")},repeat:function(t){return new Array(t+1).join(this)},startsWith:function(t){return 0===this.indexOf(t)},endsWith:function(t){t=String(t);var i=this.lastIndexOf(t);return i>=0&&i===this.length-t.length},contains:function(){return console.warn("String.prototype.contains is deprecated. You can use String.prototype.includes"),this.includes.apply(this,arguments)},includes:function(){return-1!==String.prototype.indexOf.apply(this,arguments)},toArray:function(){return this.split("")}})}function n(){i(Array,{every:function(t,i,e){for(var n=!0,r=t.length>>>0,u=0;r>u;u++)if(void 0!==t[u]&&!i.call(e,t[u],u,t)){n=!1;break}return n},forEach:function(t,i,e){for(var n=t.length>>>0,r=0;n>r;r++)void 0!==t[r]&&i.call(e,t[r],r,t)},map:function(t,i,e){for(var n=[],r=t.length>>>0,u=0;r>u;u++)void 0!==t[u]&&n.push(i.call(e,t[u],u,t));return n},filter:function(t,i,e){return Array.prototype.filter.call(t,i,e)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},concat:function(t,i){function e(t){return t}return this.map(t,e).concat(this.map(i,e))}})}function r(){i(Function.prototype,{bind:function(i){if("function"!=typeof this)throw new TypeError("Function bind not callable");var e=Array.prototype.slice,n=e.call(arguments,1),r=this,u=function(){},o=function(){return r.apply(this instanceof u?this:i||t,n.concat(e.call(arguments)))};return u.prototype=this.prototype,o.prototype=new u,o}})}function u(){i(t,{console:{log:function(){},debug:function(){},warn:function(){},error:function(){}}})}function o(){i(t,{requestAnimationFrame:function(){var i=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(){var i=0;return function(e,n){var r=(new Date).getTime(),u=Math.max(0,16-(r-i)),o=t.setTimeout(function(){e(r+u)},u);return i=r+u,o}}();return i}(),cancelAnimationFrame:function(){return t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||t.msCancelAnimationFrame||clearTimeout}(),setImmediate:function(){var i=[],e=1,n="spiritual:emulated:setimmediate";return t.addEventListener("message",function(e){e.data===n&&i.length&&(i.shift().apply(t),e.stopPropagation())},!1),function(r){return i.push(r),t.postMessage(n,"*"),e++}}()})}function s(){i(console,{debug:console.log}),i(XMLHttpRequest.prototype,{overrideMimeType:function(){}}),i(XMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4})}!function(t){e(),n(),r(),u(),s(),t||o()}(!1)}(),t.gui=function(i){return new i("gui",{Namespace:i,version:"-1.0.0",debug:!1,PARAM_CONTEXTID:"gui-contextid",PARAM_XHOST:"gui-xhost",BROADCAST_TODOM:"gui-broadcast-todom",BROADCAST_ONDOM:"gui-broadcast-ondom",BROADCAST_TOLOAD:"gui-broadcast-toload",BROADCAST_ONLOAD:"gui-broadcast-onload",BROADCAST_TOUNLOAD:"gui-broadcast-tounload",BROADCAST_ONUNLOAD:"gui-broadcast-unload",BROADCAST_WILL_UNLOAD:"gui-broadcast-will-unload",BROADCAST_MOUSECLICK:"gui-broadcast-mouseevent-click",BROADCAST_MOUSEMOVE:"gui-broadcast-mouseevent-mousemove",BROADCAST_MOUSEDOWN:"gui-broadcast-mouseevent-mousedown",BROADCAST_MOUSEUP:"gui-broadcast-mouseevent-mouseup",BROADCAST_SCROLL:"gui-broadcast-window-scroll",BROADCAST_RESIZE:"gui-broadcast-window-resize",BROADCAST_RESIZE_END:"gui-broadcast-window-resize-end",BROADCAST_POPSTATE:"gui-broadcast-window-popstate",BROADCAST_HASHCHANGE:"gui-broadcast-window-hashchange",BROADCAST_ORIENTATIONCHANGE:"gui-broadcast-orientationchange",BROADCAST_TWEEN:"gui-broadcast-tween",ACTION_DOC_ONDOMCONTENT:"gui-action-document-domcontent",ACTION_DOC_ONLOAD:"gui-action-document-onload",ACTION_DOC_ONHASH:"gui-action-document-onhash",ACTION_DOC_UNLOAD:"gui-action-document-unload",TIMEOUT_RESIZE_END:250,orientation:0,ORIENTATION_PORTRAIT:0,ORIENTATION_LANDSCAPE:1,$contextid:null,context:t,document:null,hosted:!1,xhost:"*",initialized:!1,unloading:!1,init:function(t,i){var e=this.initialized;return arguments.length&&(e?t.call(i):(this._initcallbacks=this._initcallbacks||[],this._initcallbacks.push(function(){if(gui.debug)try{t.call(i)}catch(e){throw console.error(t.toString()),e}else t.call(i)}))),e},ready:function(t,i){return this.init(t,i)},module:function(t,i){var e;if(gui.Type.isString(t)&&t.length)return e=gui.Module.extend(t,i||{}),i=gui.Module.$register(new e(t));throw new Error("Module needs an identity token")},hasModule:function(t){return gui.Module.$hasModule(t)},namespaces:function(){return i.namespaces.map(function(t){return t.$ns})},spacenames:function(){i.namespaces.forEach(function(t){t.spacename()})},namespace:function(t,i){var e;if(!gui.Type.isString(t))throw new TypeError("Expected a namespace string");return e=gui.Object.lookup(t),e=new gui.Namespace(t),e=gui.Object.assert(t,e),gui.Object.extend(e,i||{})},broadcastGlobal:function(t,i){gui.Type.isEvent(i)&&(i=new gui.EventSummary(i)),gui.Broadcast.dispatchGlobal(t,i)},_initcallbacks:null,_exist:function(){return this.hosted=t!==parent,this.$contextid="key"+Math.random().toString().slice(2,11),this.hosted&&(this.xhost="*"),this},$initialize:function(){this.spacenames(),this.initialized=!0;var t=this._initcallbacks;if(t){for(;t.length;)t.shift()();this._initcallbacks=null}},$shutdown:function(){this.unloading=!0}})._exist()}(function(){function t(i,e){t.namespaces.push(this),this.$ns=i,e&&Object.keys(e).forEach(function(t){Object.defineProperty(this,t,Object.getOwnPropertyDescriptor(e,t))},this)}return t.namespaces=[],t.prototype={$ns:null,toString:function(){return"[namespace "+this.$ns+"]"},spacename:function(){return this._spacename(this,this.$ns),this},_spacename:function(t,i){gui.Object.each(t,function(t,e){"$superclass"!==t&&gui.Type.isConstructor(e)&&e.$classname===gui.Class.ANONYMOUS&&(Object.defineProperty(e,"$classname",{value:i+"."+t,enumerable:!0,writable:!1}),this._spacename(e,i+"."+t))},this)}},t}()),gui.KeyMaster={generateKey:function(){var t=Math.random().toString(),i="key"+t.slice(2,11);return this._keys[i]?i=this.generateKey():this._keys[i]=!0,i},generateGUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=16*Math.random()|0,e="x"===t?i:3&i|8;return e.toString(16)}).toLowerCase()},isKey:function(t){var i=null,e=!1;return gui.Type.isString(t)&&(i=this.extractKey(t),e=i&&i[0]===t),e},extractKey:function(t){return/key\d{9}/.exec(t)},_keys:Object.create(null)},gui.Object={create:function(t,i){var e={};return Object.keys(i).forEach(function(t){e[t]={value:i[t],writable:!0,enumerable:!0,configurable:!0}}),Object.create(t,e)},extend:function(t,i,e){var n=this._hiding;if(!gui.Type.isObject(i))throw new TypeError("Expected object, got "+gui.Type.of(i));return Object.keys(i).forEach(function(r){if(!e||!gui.Type.isDefined(t[r])){var u=Object.getOwnPropertyDescriptor(i,r);u=n?gui.Object._hide(u):u,Object.defineProperty(t,r,u)}},this),t},extendmissing:function(t,i){return this.extend(t,i,!0)},copy:function(t){try{return this.extend({},t)}catch(i){throw new TypeError("Could not object-copy "+gui.Type.of(t))}},each:function(t,i,e){return Object.keys(t).map(function(n){return i.call(e,n,t[n])}).filter(function(t){return void 0!==t})},all:function(t,i,e){var n=[];for(var r in t)n.push(i.call(e,r,t[r]));return n.filter(function(t){return void 0!==t})},map:function(t,i,e){var n,r={};return this.each(t,function(t,u){n=i.call(e,t,u),void 0!==n&&(r[t]=n)}),r},lookup:function(t,i){var e,n=i||self;if(!gui.Type.isString(t))throw new TypeError("Expected string, got "+gui.Type.of(t));if(t.includes(".")){var r=t.split(".");r.every(function(t){return n=n[t],gui.Type.isDefined(n)}),e=n}else e=n[t];return e},assert:function(t,i,e){var n,r=e||self;if(t.includes(".")){var u=t.split(".");n=u.pop(),u.forEach(function(t){r=r[t]||(r[t]={})})}else n=t;return r&&(r[n]=i),i},methods:function(t){var i,e,n,r=t,u=[];for(i in t){for(;!(n=Object.getOwnPropertyDescriptor(r,i));)r=Object.getPrototypeOf(r);"function"==typeof n.value&&(e=t[i],gui.Type.isMethod(e)&&u.push(i))}return u},ownmethods:function(t){return Object.keys(t).filter(function(i){return gui.Type.isMethod(t[i])}).map(function(t){return t})},nonmethods:function(t){var i=[];for(var e in t)gui.Type.isFunction(t[e])||i.push(e);return i},bindall:function(t){var i=Array.prototype.slice.call(arguments).slice(1);return i.length||(i=gui.Object.ownmethods(t).filter(function(t){return"_"!==t[0]})),i.forEach(function(i){t[i]=t[i].bind(t)}),t},hidden:function(t){return gui.Object._hiding=!0,t.$hidden=!0,t},_hiding:!1,_hide:function(t){return t.value&&gui.Type.isFunction(t.value)&&t.value.$hidden&&t.configurable&&(t.enumerable=!1),t}},gui.Type={of:function(t){var i={}.toString.call(t).match(this._typeexp)[1].toLowerCase();return"domwindow"===i&&"undefined"===String(typeof t)&&(i="undefined"),i},isDefined:function(t){return"undefined"!==this.of(t)},isComplex:function(t){switch(this.of(t)){case"undefined":case"boolean":case"number":case"string":case"null":return!1}return!0},isWindow:function(t){return t&&t.document&&t.location&&t.alert&&t.setInterval},isEvent:function(t){return this.of(t).endsWith("event")&&this.isDefined(t.type)},isElement:function(t){return this.of(t).endsWith("element")&&t.nodeType===Node.ELEMENT_NODE},isDocumentFragment:function(t){return t&&t.nodeName&&"#document-fragment"===t.nodeName},isDocument:function(t){return t&&t.nodeType===Node.DOCUMENT_NODE},isMethod:function(t){return t&&this.isFunction(t)&&!this.isConstructor(t)&&!String(t).includes("[native code]")},isSpirit:function(t){return t&&t instanceof gui.Spirit},isConstructor:function(t){return this.isFunction(t)&&this.isObject(t.prototype)&&Object.keys(t.prototype).length},isGuiClass:function(t){return this.isConstructor(t)&&t.$classname},isSpiritConstructor:function(t){return this.isFunction(t)&&this.isFunction(t.summon)},isArrayLike:function(t){return"0"in t&&!this.isArray(t)},cast:function(t){var i=String(t);switch(i){case"null":i=null;break;case"true":case"false":i="true"===i;break;default:String(parseInt(i,10))===i?i=parseInt(i,10):String(parseFloat(i))===i&&(i=parseFloat(i))}return i},_typeexp:/\s([a-zA-Z]+)/},function(){["array","function","object","string","number","boolean","null","arguments","file"].forEach(function(t){this["is"+t[0].toUpperCase()+t.slice(1)]=function(i){return this.of(i)===t}},this)}.call(gui.Type),gui.Object.bindall(gui.Type),gui.Array={of:function(){var t=Array.prototype.slice;return Array.of||function(){return t.call(arguments)}}(),from:function(){return Array.from||function(t){for(var i=[],e=Object(t),n=e.length>>>0,r=0;n>r;)r in e&&(i[r]=e[r]),r++;return i}}(),make:function(t){switch(gui.Type.of(t)){case"string":return t.split(" ");case"array":return this.from(t);default:return gui.Type.isArrayLike(t)?this.from(t):[t]}},remove:function(t,i,e){var n=gui.Array.from(arguments).slice(1);return n.some(isNaN)?this.remove.apply(this,[t].concat(n.map(function(i){return isNaN(i)?t.indexOf(i):i}))):(t.splice(i,!e||1+e-i+(!(0>e^i>=0)&&(0>e||-1)*t.length)),t.length)}},gui.Arguments={provided:function(){var t=gui.Array.from(arguments);return function(i){return function(){return gui.Arguments._match(arguments,t)?i.apply(this,arguments):void 0}}},confirmed:function(){var t=gui.Array.from(arguments);return function(i){return function(){return gui.Arguments._validate(arguments,t)?i.apply(this,arguments):void gui.Arguments._abort(this)}}},_validating:!1,_bugsummary:null,_match:function(t,i){return i.every(function(i,e){return this._matches(i,t[e],e)},this)},_validate:function(t,i){this._validating=!0;var e=this._match(t,i);return this._validating=!1,e},_xtract:function(t,i){return i?t.slice(1,-1):t},_matches:function(t,i,e){var n=!t.startsWith("("),r=this._xtract(t,!n).split("|"),u=gui.Type.of(i),o="*"===t||"node"===t&&i&&i.nodeType||"constructor"===t&&i&&gui.Type.isConstructor(i)||"element"===t&&i&&i.nodeType===Node.ELEMENT_NODE||"spirit"===t&&i&&i.$instanceid&&i.element||!n&&"undefined"===u||!n&&r.indexOf("*")>-1||r.indexOf(u)>-1;return!o&&this._validating&&("string"===u&&(i='"'+i+'"'),this._bugsummary=[e,t,u,i]),o},_abort:function(t){var i=this._bugsummary,e=t.constructor.$classname||String(t);console.error(["Spiritual GUI: Bad argument "+i.shift(),"for "+e+":","Expected "+i.shift()+",","got "+i.shift()+":",i.shift()].join(" "))}},gui.Function={create:function(t,i,e,n){var r=n?n.Function:Function;return t=this.safename(t),i=i?i.join(","):"",e=e||"",new r("return function "+t+" ( "+i+" ) {"+e+"}")()},decorateBefore:gui.Arguments.confirmed("object|function","string","function")(function(t,i,e){return this._decorate("before",t,i,e)}),decorateAfter:gui.Arguments.confirmed("object|function","string","function")(function(t,i,e){return this._decorate("after",t,i,e)}),decorateAround:function(){throw new Error("TODO")},safename:function(t){return t&&t.includes(".")&&(t=t.split(".").pop()),t||""},_decorate:function(t,i,e,n){return i[e]=gui.Combo[t](n)(i[e]),i}},gui.Class={create:function(){var t=this._breakdown_base(arguments),i=this._createclass(null,t.proto,t.name);return gui.Object.extend(i.prototype,t.protos),gui.Object.extend(i,t.statics),gui.Property.extendall(t.protos,i.prototype),t.recurring&&gui.Object.each(t.recurring,function(t,e){var n=Object.getOwnPropertyDescriptor(i,t);(!n||n.writable)&&(i[t]=i.$recurring[t]=e)}),i},get:function(t){return this._classes[t]||null},$constructor:function(){var t=this.$onconstruct||this.onconstruct,i=gui.Property.nonenumerable,e=this;return Object.defineProperties(this,{$instanceid:i({value:gui.KeyMaster.generateKey()}),displayName:i({value:this.constructor.displayName,writable:!0})}),gui.Type.isFunction(t)&&(e=t.apply(this,arguments)),e||this},_classes:Object.create(null),ANONYMOUS:"Anonymous",_BODY:function(t){var i=t.toString().trim();return i.slice(i.indexOf("{")+1,-1)}(function i(){return this instanceof i?gui.Class.$constructor.apply(this,arguments):i.extend.apply(i,arguments)}),_breakdown_base:function(t){var i=gui.Type.isString(t[0]);return{name:i?t[0]:null,proto:t[i?1:0]||Object.create(null),protos:t[i?2:1]||Object.create(null),recurring:t[i?3:2]||Object.create(null),statics:t[i?4:3]||Object.create(null)}},_breakdown_subs:function(t){var i=gui.Type.isString(t[0]);return{name:i?t[0]:null,protos:t[i?1:0]||Object.create(null),recurring:t[i?2:1]||Object.create(null),statics:t[i?3:2]||Object.create(null)}},_createclass:function(t,i,e){e=e||gui.Class.ANONYMOUS;var n=function r(){return this instanceof r?gui.Class.$constructor.apply(this,arguments):r.extend.apply(r,arguments)};return n.$classid=gui.KeyMaster.generateKey(),n.prototype=Object.create(i||null),n.prototype.constructor=n,n=this._internals(n,t),n=this._interface(n),n=this._classname(n,e),this._classes[n.$classid]=n,n},_createsubclass:function(t,i){return i=this._breakdown_subs(i),this._extendclass(t,i.protos,i.recurring,i.statics,i.name)},_extendclass:function(t,i,e,n,r){var u=this._createclass(t,t.prototype,r);return gui.Object.extend(u,n),gui.Object.extend(u.$recurring,e),gui.Object.each(u.$recurring,function(t,i){var e=Object.getOwnPropertyDescriptor(u,t);(!e||e.writable)&&(u[t]=i)}),gui.Property.extendall(i,u.prototype),u=this._classname(u,r)},_internals:function(t,i){return t.$super=null,t.$subclasses=[],t.$superclass=i||null,t.$recurring=i?gui.Object.copy(i.$recurring):Object.create(null),i&&i.$subclasses.push(t),t},_interface:function(t){return["extend","mixin","is"].forEach(function(i){t[i]=this[i]},this),t},_classname:function(t,i){return t.$classname=i||gui.Class.ANONYMOUS,Object.defineProperty(t.prototype,"$classname",{enumerable:!1,configurable:!0,get:function(){return this.constructor.$classname}}),t.toString=function(){return"[function "+this.$classname+"]"},t.prototype.toString=function(){return"[object "+this.constructor.$classname+"]"},t},_namedbody:function(t){return this._BODY.replace(new RegExp("\\$name","gm"),gui.Function.safename(t))}},gui.Object.extend(gui.Class,{extend:function(){return gui.Class._createsubclass(this,arguments)},mixin:function(t,i,e){return Array.forEach(arguments,function(t,i){t&&gui.Object.each(t,function(t,e){0===i?this.prototype[t]=e:gui.Class.descendantsAndSelf(this,function(i){i.$recurring[t]=e,i[t]=e})},this)},this),this},is:function(t){return gui.Type.isObject(t)&&t instanceof this},isInstance:function(){console.error("Deprecated API is derecated")}}),gui.Object.extend(gui.Class,{children:function(t,i,e){var n=[];return i=i||gui.Combo.identity,t.$subclasses.forEach(function(t){n.push(i.call(e,t))},e),n},descendants:function(t,i,e,n){return n=n||[],i=i||gui.Combo.identity,t.$subclasses.forEach(function(t){n.push(i.call(e,t)),gui.Class.descendants(t,i,e,n)},e),n},descendantsAndSelf:function(t,i,e){var n=[];return i=i||gui.Combo.identity,n.push(i.call(e,t)),this.descendants(t,i,e,n)},parent:function(t,i,e){return t&&t.$superclass?(i=i||gui.Combo.identity,i.call(e,t.$superclass)):null},ancestors:function(t,i,e,n){return n=n||[],i=i||gui.Combo.identity,t.$superclass&&(n.push(i.call(e,t.$superclass)),gui.Class.ancestors(t.$superclass,i,e,n)),n},ancestorsAndSelf:function(t,i,e){var n=[];return i=i||gui.Combo.identity,n.push(i.call(e,t)),this.ancestors(t,i,e,n)},family:function(t,i,e){var n=this.ancestorsAndSelf(t).concat(this.descendants(t));return i&&(n=n.map(function(t){return i.call(e,t)})),n}}),gui.Property={extendall:function(t,i){return Object.keys(t).forEach(function(e){this.extend(t,i,e)},this),i},extend:function(t,i,e){var n=Object.getOwnPropertyDescriptor(t,e);return n=this._accessor(i,e,n),Object.defineProperty(i,e,n),i},nonenumerable:function(t){return gui.Object.extendmissing({configurable:!0,enumerable:!1},t)},accessor:function(t,i,e){if(this._isaccessor(e))return Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:e.getter||this._NOGETTER,set:e.setter||this._NOSETTER});throw new TypeError("Expected getter and/or setter method")},_isaccessor:function(t){return Object.keys(t).every(function(i){var e=!1;switch(i){case"getter":case"setter":e=gui.Type.isFunction(t[i])}return e})},_accessor:function(t,i,e){var n=e.value;return gui.Type.isObject(n)&&(n.getter||n.setter)&&this._isactive(n)&&(e=this._activeaccessor(t,i,n)),e},_isactive:function(t){return Object.keys(t).every(function(i){var e=!1;switch(i){case"getter":case"setter":e=gui.Type.isFunction(t[i])}return e})},_activeaccessor:function(t,i,e){var n;return["getter","setter"].forEach(function(r,u){for(;t&&t[i]&&!gui.Type.isDefined(e[r]);)t=Object.getPrototypeOf(t),n=Object.getOwnPropertyDescriptor(t,i),n&&(e[r]=n[u?"set":"get"])}),{enumerable:!0,configurable:!0,get:e.getter||this._NOGETTER,set:e.setter||this._NOSETTER}},_NOGETTER:function(){throw new Error("Getting a property that has only a setter")},_NOSETTER:function(){throw new Error("Setting a property that has only a getter")}},gui.Object.bindall(gui.Property),gui.Interface={validate:function(t,i){var e=!0,n=t.toString(),r=gui.Type.of(i);switch(r){case"null":case"string":case"number":case"boolean":case"undefined":throw new Error("Expected "+n+", got "+r+": "+i);default:try{var u=null,o=null;if(e=Object.keys(t).every(function(e){return u=e,o=gui.Type.of(t[e]),gui.Type.of(i[e])===o}),!e)throw new Error("Expected "+n+". A required "+r+' "'+u+'" is missing')}catch(s){throw new Error("Expected "+n)}}return e}},gui.Combo={before:function(t){return function(i){return function(){return t.apply(this,arguments),i.apply(this,arguments)}}},after:function(t){return function(i){return function(){var e=i.apply(this,arguments);return t.apply(this,arguments),e}}},around:function(t){var i=[].slice;return function(e){return function(){var n,r,u,o=this;return n=1<=arguments.length?i.call(arguments,0):[],u=void 0,r=function(){return u=e.apply(o,n)},t.apply(this,[r].concat(n)),u}}},provided:function(t){return function(i,e){return function(){return t.apply(this,arguments)?i.apply(this,arguments):e?e.apply(this,arguments):void 0}}},chained:function(t){return function(){var i=t.apply(this,arguments);return void 0===i?this:i}},memoized:function(t){var i;return i={},function(){var e;return e=JSON.stringify(arguments),i.hasOwnProperty(e)?i[e]:i[e]=t.apply(this,arguments)}},identity:function(t){return t}},gui.Plugin=gui.Class.create(Object.prototype,{client:null,spirit:null,context:null,onconstruct:function(){},ondestruct:function(){},handleEvent:function(t){gui.Type.isFunction(this.onevent)&&this.onevent(t)},$destructed:!1,$onconstruct:function(i){this.client=i,gui.hasModule("gui-spirits@wunderbyte.com")&&i instanceof gui.Spirit&&(this.spirit=i||null,this.context=t),this.onconstruct()},$ondestruct:function(){}},{lazy:!0},{$prepare:function(t,i,e){Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:function(){var n=new e(this);return this.life.plugins[i]=!0,gui.Plugin.$assign(t,i,n),n}})},$assign:function(t,i,e){Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:function(){return e},set:function(){throw new Error('The property name "'+i+'" is reserved for the '+e.$classname+" and cannot be redefined.")}})}}),gui.SuperPlugin=function(t){return gui.Plugin.extend({onconstruct:function(){t.onconstruct.call(this),console.error(["Note that 'this.super' doesn't really exist. You can either:","1) compile the script serverside using 'grunt-spiritual-build' or","2) use the pattern 'SuperClass.prototype.methodname.apply(this)'","(the Grunt task basically just applies this pattern to the code)"].join("\n"))}})}(gui.Plugin.prototype),gui.TrackerPlugin=gui.Plugin.extend({onconstruct:function(){gui.Plugin.prototype.onconstruct.call(this),this._trackedtypes=Object.create(null),this.spirit&&(this._sig=gui.$contextid)},ondestruct:function(){gui.Plugin.prototype.ondestruct.call(this),gui.Object.each(this._trackedtypes,function(t,i){i.slice().forEach(function(i){this._cleanup(t,i)},this)},this)},toggle:function(t,i){console.error("TODO: SpiritTracker#toggle")},shift:function(t){var i=gui.Array.from(arguments).slice(1);return t?this.add.apply(this,i):this.remove.apply(this,i)},shiftGlobal:function(t){return this._globalize(function(){return this.shift.apply(arguments)})},contains:function(t){return gui.Array.make(t).every(function(t){return this._trackedtypes[t]},this)},_global:!1,_trackedtypes:null,_sig:null,_globalize:function(t){this._global=!0;var i=t.call(this);return this._global=!1,i},_addchecks:function(t,i){var e=!1,n=this._trackedtypes[t];return n?e=!this._haschecks(n,i):(n=this._trackedtypes[t]=[],e=!0),e&&i&&n.push(i),e},_removechecks:function(t,i){var e=!1,n=this._trackedtypes[t];if(n){var r=this._checksindex(n,i);r>-1&&(e=!0,0===gui.Array.remove(n,r)&&delete this._trackedtypes[t])}return e},_containschecks:function(t,i){var e=!1,n=this._trackedtypes[t];return n&&(e=!i||this._haschecks(n,i)),e},_haschecks:function(t,i){var e=!i||!1;return e||t.every(function(t){return t.every(function(t,e){return t===i[e]})&&(e=!0),!e}),e},_hashandlers:function(){return Object.keys(this._trackedtypes).length>0},_checksindex:function(t,i){var e=-1;return t.every(function(t,n){return t.every(function(t,e){return t===i[e]})&&(e=n),-1===e}),e},_cleanup:function(t,i){this._removechecks(t,i)}}),gui.Action=function(t,i){return gui.hosted&&addEventListener("message",function(t){t.source===parent&&gui.Action.$maybeDescendGlobal(t.data)}),gui.Class.create(Object.prototype,{target:null,type:null,data:null,direction:null,global:!1,isConsumed:!1,isCancelled:!1,consumer:null,instanceid:null,onconstruct:function(t){gui.Object.extend(this,t)},consume:function(t){this.isConsumed=!0,this.consumer=t},cancel:function(t){this.isCancelled=!0,this.consume(t)}},{},{DESCEND:"descend",ASCEND:"ascend",IActionHandler:{onaction:function(t){},toString:function(){return"[interface ActionHandler]"}},add:t("node","array|string","object|function")(i(function(t,i,e){this._listen(!0,t,i,e,!1)})),remove:t("node","array|string","object|function")(i(function(t,i,e){this._listen(!1,t,i,e,!1)})),addGlobal:t("node","array|string","object|function")(i(function(t,i,e){this._listen(!0,t,i,e,!0)})),removeGlobal:t("node","array|string","object|function")(i(function(t,i,e){this._listen(!1,t,i,e,!0)})),dispatch:function(t,i,e){return this.ascend(t,i,e)},ascend:function(t,i,e){return this._dispatch(t,i,e,gui.Action.ASCEND,!1)},descend:function(t,i,e){return this._dispatch(t,i,e,gui.Action.DESCEND,!1)},dispatchGlobal:function(t,i,e){return this.ascendGlobal(t,i,e)},ascendGlobal:function(t,i,e){return this._dispatch(t,i,e,gui.Action.ASCEND,!0)},descendGlobal:function(t,i,e){return this._dispatch(t,i,e,gui.Action.DESCEND,!0)},stringify:function(t,i){var e="spiritual-action:";return e+function(){return t.target=null,t.data=function(t){if(gui.Type.isComplex(t))if(gui.Type.isFunction(t.stringify))t=t.stringify();else try{JSON.stringify(t)}catch(i){t=null}return t}(t.data),t.instanceid=i||null,JSON.stringify(t)}()},parse:function(t){var i="spiritual-action:";return t.startsWith(i)?new gui.Action(JSON.parse(t.split(i)[1])):null},$maybeDescendGlobal:function(t){var i,e,n,r=t;gui.Type.isString(r)&&r.startsWith("spiritual-action:")&&(i=gui.Action.parse(r),i.direction===gui.Action.DESCEND&&((n=this._globals[i.type])&&n.slice().forEach(function(t){t.onaction(i)}),gui.hasModule("gui-spirits@wunderbyte.com")&&(e=gui.get("html"))&&(e.action.$handleownaction=!0,e.action.descendGlobal(i.type,i.data))))},_globals:{},_locals:{},_listen:function(t,i,e,n,r){if(i.nodeType!==Node.DOCUMENT_NODE)throw new TypeError("Document node expected");var u=r?this._globals:this._locals,o=u[e],s=gui.Action.IActionHandler;gui.Interface.validate(s,n)&&gui.Array.make(e).forEach(function(i){t?(o||(o=u[e]=[]),-1===o.indexOf(n)&&o.push(n)):o&&0===gui.Array.remove(o,n)&&delete u[e]})},_dispatch:function(t,i,e,n,r){var u=new gui.Action({target:t,type:i,data:e,direction:n||gui.Action.ASCEND,global:r||!1}),o=new gui.Crawler(gui.CRAWLER_ACTION);return o.global=u.global||!1,o[u.direction](t,{handleSpirit:function(t){var e=gui.Crawler.CONTINUE;return t.action.contains(i)&&(t.action.$onaction(u),u.isConsumed&&(e=gui.Crawler.STOP,u.consumer=t)),e},transcend:function(t,i,e){var n=gui.Action.stringify(u,e);t.postMessage(n,"*")}}),u}})}(gui.Arguments.confirmed,gui.Combo.chained),gui.Broadcast=function(i,e){return t.addEventListener("message",function(t){gui.Type.isString(t.data)&&t.data.startsWith("spiritual-broadcast:")&&gui.Broadcast.$maybeBroadcastGlobal(t.data)}),gui.Class.create(Object.prototype,{target:null,type:null,data:null,global:!1,$contextid:null,$contextids:null,$onconstruct:function(t){gui.Object.extend(this,t),this.$contextids=this.$contextids||[]}},{},{IBroadcastHandler:{onbroadcast:function(t){},toString:function(){return"[interface BroadcastHandler]"}},$target:null,_globals:Object.create(null),_locals:Object.create(null),add:e(function(t,i,e){this._add(t,i,e||gui.$contextid)}),remove:e(function(t,i,e){this._remove(t,i,e||gui.$contextid)}),addGlobal:e(function(t,i){this._add(t,i)}),removeGlobal:e(function(t,i){this._remove(t,i)}),dispatch:function(t,i){return gui.Type.isString(t)?this._dispatch({type:t,data:i,global:!1}):(console.error('The "target" argument (the first argument) of gui.Broadcast.dispatch is deprecated'),void this.dispatch(arguments[1],arguments[2]))},dispatchGlobal:function(t,i){return gui.Type.isString(t)?this._dispatch({type:t,data:i,global:!0,$contextid:gui.$contextid}):(console.error('The "target" argument (the first argument) of gui.Broadcast.dispatchGlobal is deprecated'),this.dispatchGlobal(arguments[1],arguments[2]))},stringify:function(t){var i="spiritual-broadcast:";return i+function(){return t.target=null,t.data=function(t){if(gui.Type.isComplex(t))if(gui.Type.isFunction(t.stringify))t=t.stringify();else try{JSON.stringify(t)}catch(i){t=null}return t}(t.data),JSON.stringify(t)}()},parse:function(t){var i="spiritual-broadcast:";return t.startsWith(i)?JSON.parse(t.split(i)[1]):void 0},$maybeBroadcastGlobal:function(t){var i=gui.Broadcast.parse(t);-1===i.$contextids.indexOf(gui.$contextid)&&gui.Broadcast._dispatch(i)},_add:i("array|string","object|function","(string)")(function(t,i,e){gui.Broadcast.IBroadcastHandler;if(gui.Type.isArray(t))t.forEach(function(t){this._add(t,i,e)},this);else{var n;e?(n=this._locals[e],n||(n=this._locals[e]=Object.create(null))):n=this._globals,n[t]||(n[t]=[]);var r=n[t];-1===r.indexOf(i)&&r.push(i)}}),_remove:function(t,i,e){gui.Broadcast.IBroadcastHandler;if(gui.Type.isArray(t))t.forEach(function(t){this._remove(t,i,e)},this);else{var n,r=function(i,n){return e?i[e]?i[e][t]:void 0:n[t]}(this._locals,this._globals);r&&(n=r.indexOf(i),n>-1&&gui.Array.remove(r,n))}},_dispatch:function(t){var i=t.global?this._globals:this._locals[gui.$contextid];if(gui.hasModule("gui-spirits@wunderbyte.com")&&(gui.spiritualized||t.type!==gui.BROADCAST_WILL_SPIRITUALIZE),this.$target&&(t.global||(t.target=this.$target),this.$target=null),t instanceof gui.Broadcast==!1&&(t=new gui.Broadcast(t)),i){var e=i[t.type];e&&e.slice().forEach(function(i){i.onbroadcast(t)})}return t.global&&this._propagate(t),t},_propagate:function(t){var i=function(){return t.$contextids.push(gui.$contextid),gui.Broadcast.stringify(t)}();this._propagateDown(i),this._propagateUp(i,t.type)},_propagateDown:function(t){var i=document.querySelectorAll("iframe");Array.forEach(i,function(i){i.contentWindow.postMessage(t,"*")})},_propagateUp:function(i){t!==top&&parent.postMessage(i,"*")}})}(gui.Arguments.confirmed,gui.Combo.chained),function(t){gui.Tick=function(t){this.type=t},gui.Tick.prototype={type:null,toString:function(){return"[object gui.Tick]"}},gui.Object.extend(gui.Tick,{toString:function(){return"[function gui.Tick]"},add:t("string|array","object|function","(string)")(function(t,i,e){return this._add(t,i,!1,e||gui.$contextid)}),remove:t("string|array","object|function","(string)")(function(t,i,e){return this._remove(t,i,e||gui.$contextid)}),one:t("string|array","object|function","(string)")(function(t,i,e){return this._add(t,i,!0,e||gui.$contextid)}),next:function(t,i){setImmediate(function(){t.call(i)})},nextFrame:function(t,i){return requestAnimationFrame(function(e){t.call(i,e)})},cancelFrame:function(t){cancelAnimationFrame(t)},time:t("function","(number)","(function|object)")(function(t,i,e){return setTimeout(function(){t.call(e)},i||0)}),cancelTime:function(t){clearTimeout(t)},start:t("string","(number)")(function(t,i){var e=this._intervals;if(!e[t]){var n=new gui.Tick(t);e[t]=setInterval(function(){this._doit(n)}.bind(this),i||0)}}),stop:t("string")(function(t){var i=this._intervals,e=i[t];e&&(clearInterval(e),delete i[t])}),dispatch:function(t,i,e){return this._dispatch(t,i,e||gui.$contextid)},_intervals:Object.create(null),_tempname:{types:Object.create(null),handlers:Object.create(null)},_add:function(t,i,e,n){if(gui.Type.isArray(t))t.forEach(function(t){this._add(t,i,e,n)},this);else{var r,u,o=this._tempname;r=o.handlers[t],r||(r=o.handlers[t]=[]),u=r.indexOf(i),0>u&&(u=r.push(i)-1),e&&(r._one=r._one||Object.create(null),r._one[u]=!0)}return this},_remove:function(t,i,e){if(gui.Type.isArray(t))t.forEach(function(t){this.remove(t,i,e)},this);else{var n=this._tempname,r=n.handlers[t];if(r){var u=r.indexOf(i);0===gui.Array.remove(r,u)&&delete n.handlers[t]}}return this},_dispatch:function(t,i,e){var n=this._tempname,r=n.types,u=new gui.Tick(t);if(i=i||0,!r[t]){r[t]=!0;var o=this,s=null;s=i?setTimeout(function(){delete r[t],o._doit(u)},i):setImmediate(function(){delete r[t],o._doit(u)})}return u},_doit:function(t){var i=this._tempname.handlers[t.type];i&&i.slice().forEach(function(i){i.ontick(t)})}})}(gui.Arguments.confirmed),gui.Document=function(){function i(t,i){gui.hosted&&gui.Action.ascendGlobal(document,t,i)}function e(){gui.Array.make(arguments).forEach(function(t){gui.Broadcast.dispatch(t);
})}return gui.Class.create(Object.prototype,{onconstruct:function(){var i=this,e=function(t,e,n){e.split(" ").forEach(function(e){t.addEventListener(e,i,n)})};e(document,"DOMContentLoaded"),e(document,"click mousedown mouseup",!0),e(t,"load hashchange"),gui.hosted||e(t,"resize orientationchange"),t.chrome&&chrome.app&&chrome.runtime||e(t,"unload")},handleEvent:function(t){switch(t.type){case"click":case"mousedown":case"mouseup":this._onmouseevent(t);break;case"orientationchange":this._onrotate();break;case"resize":this._onresize();break;case"DOMContentLoaded":this._ondom();break;case"load":this._onload();break;case"unload":this._onunload();break;case"hashchange":this._onhashchange()}},_loaded:!1,_domloaded:!0,_timeout:-1,_ondom:function(){this._domloaded=!0,gui.$initialize(),this._configure(gui.namespaces()),i(gui.ACTION_DOC_ONDOMCONTENT,location.href),e(gui.BROADCAST_TODOM,gui.BROADCAST_ONDOM)},_onload:function(){this._loaded=!0,e(gui.BROADCAST_TOLOAD,gui.BROADCAST_ONLOAD),i(gui.ACTION_DOC_ONLOAD,location.href)},_onunload:function(){this._unloaded=!0,gui.$shutdown(),e(gui.BROADCAST_TOUNLOAD,gui.BROADCAST_ONUNLOAD),i(gui.ACTION_DOC_UNLOAD,location.href)},_onhashchange:function(){i(gui.ACTION_DOC_ONHASH,location.hash)},_onmouseevent:function(t){gui.broadcastGlobal({click:gui.BROADCAST_MOUSECLICK,mousedown:gui.BROADCAST_MOUSEDOWN,mouseup:gui.BROADCAST_MOUSEUP}[t.type],gui.$contextid)},_onresize:function(){gui.hosted||(clearTimeout(this._timeout),this._timeout=setTimeout(function(){gui.broadcastGlobal(gui.BROADCAST_RESIZE_END)},gui.TIMEOUT_RESIZE_END))},_onrotate:function(){gui.hosted||(gui.orientation=t.innerWidth>t.innerHeight?1:0,gui.broadcastGlobal(gui.BROADCAST_ORIENTATIONCHANGE,gui.orientation))},_configure:function(t){var i,e,n=document.querySelectorAll("meta[name]");Array.forEach(n,function(n){i=n.getAttribute("name"),t.forEach(function(t){i.startsWith(t+".")&&(e=gui.Object.lookup(i),gui.Type.isDefined(e)?gui.Object.assert(i,gui.Type.cast(n.getAttribute("content"))):console.error('No definition for "'+i+'"'))})})}})}(),gui.document=new gui.Document,gui.Module=gui.Class.create(Object.prototype,{oncontextinitialize:function(){},onrun:function(){},ondom:function(){},onload:function(){},onunload:function(){},$modname:null,$onconstruct:function(t){this.$modname=t,this.toString=function(){return"[module "+t+"]"}}},{},{$register:function(i){var e=i.$modname;if(this.$hasModule(e))throw new Error(e+" loaded twice?");return this._modules.push(i),gui.Type.isFunction(i.oncontextinitialize)&&i.oncontextinitialize(t),gui.Type.isFunction(i.onrun)&&i.onrun(),i},$hasModule:function(t){return this._modules.some(function(i){return i.$modname===t})},_modules:[]}),function(t){gui.Object.each({ondom:gui.BROADCAST_TODOM,onload:gui.BROADCAST_TOLOAD,onunload:gui.BROADCAST_TOUNLOAD},function(i,e){gui.Broadcast.add(e,{onbroadcast:function(){t.forEach(function(t){t[i]()})}})})}(gui.Module._modules),gui.Garbage={DENIAL:"Attempt to handle destructed object",toString:function(){return"[object gui.Garbage]"},ontick:function(i){"gui-tick-garbage-empty"===i.type&&t.gui&&this._nukemnow()},$collect:function(t){gui.unloading?this.$nuke(t):(this._spirits.push(t),gui.Tick.dispatch("gui-tick-garbage-empty"))},$nuke:function(t){var i=[],e=t.life.plugins;gui.Object.each(e,function(e,n){n?"life"!==e&&i.push(e):Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){},set:function(){}})}),e=i.map(function(i){return t[i]},this),gui.unloading||(this.$nukeplugins(e,!1),gui.Tick.next(function(){this.$nukeplugins(e,!0),this.$nukeelement(t),this.$nukeallofit(t)},this))},$nukeplugins:function(t,i){i?t.forEach(function(t){this.$nukeallofit(t)},this):t.map(function(t){return t.ondestruct(),t}).forEach(function(t){t.$ondestruct()})},$nukeelement:function(t){try{t.element.spirit=null}catch(i){}},$nukeallofit:function(t){var i=Object.prototype;if(!gui.unloading&&!t.$destructed){t.$destructed=!0;for(var e in t)if((t.hasOwnProperty(e)||gui.debug)&&void 0===i[e]&&"$destructed"!==e){var n=Object.getOwnPropertyDescriptor(t,e);(!n||n.configurable)&&(gui.debug?this._definePropertyItentified(t,e):Object.defineProperty(t,e,this.DENIED))}}},DENIED:{enumerable:!0,configurable:!0,get:function(){gui.Garbage.DENY()},set:function(){gui.Garbage.DENY()}},DENY:function(t){var i,e=new Error(gui.Garbage.DENIAL+(t?": "+t:""));!gui.Client.isExplorer&&(i=e.stack)?(i=gui.Client.isWebKit?i.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@").split("\n"):i.split("\n"),i.shift(),i.shift(),console.warn(e.message+"\n"+i)):console.warn(e.message)},_spirits:[],_definePropertyItentified:function(t,i){Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:function(){gui.Garbage.DENY(t)},set:function(){gui.Garbage.DENY(t)}})},_nukemnow:function(){var i,e=this._spirits.slice();if(t.gui){for(;i=e.shift();)this.$nuke(i);this._spirits=[]}}},gui.Tick.add("gui-tick-garbage-empty",gui.Garbage),gui.URL=function(t,i){if(!t||t.nodeType!==Node.DOCUMENT_NODE)throw new TypeError("Document expected");var e,n=gui.URL._createLink(t,i);Object.keys(gui.URL.prototype).forEach(function(t){gui.Type.isString(e=n[t])&&("pathname"!==t||e.startsWith("/")||(e="/"+e),this[t]=e)},this),this.id=this.hash?this.hash.substring(1):null,this.external=this.href.split("#")[0]!==t.URL.split("#")[0]},gui.URL.prototype={hash:null,host:null,hostname:null,href:null,pathname:null,port:null,protocol:null,search:null,id:null,external:!1,toString:function(){return this.href}},gui.URL.absolute=function(t,i){if(i=i||"",t.nodeType===Node.DOCUMENT_NODE)return new gui.URL(t,i).href;if("string"==typeof t){var e=t.split("/"),n=i.split("/");return e.pop(),n.forEach(function(t){"."!==t&&(".."===t?e.pop():e.push(t))}),e.join("/")}},gui.URL.external=function(t,i){i=i||document;var e=new gui.URL(i,t);return e.host!==i.location.host||e.port!==i.location.port},gui.URL.getParam=function(t,i){i=i.replace(/(\[|\])/g,"\\$1");var e=new RegExp("[\\?&]"+i+"=([^&#]*)").exec(t);return null===e?null:e[1]},gui.URL.setParam=function(t,i,e){var n,r=[],u=-1,o=t.split("#")[0],s=t.split("#")[1];return o.indexOf("?")>-1&&(n=o.split("?"),o=n[0],r=n[1].split("&"),r.every(function(t,n){var o=t.split("=");return o[0]===i&&(u=n,null!==e&&(o[1]=e,r[n]=o.join("="))),0>u})),null===e?u>-1&&r.remove(u,u):0>u&&(r[r.length]=[i,e].join("=")),r=r.length>0?"?"+r.join("&"):"",o+r+(s?"#"+s:"")},gui.URL.parametrize=function(t,i){return gui.Type.isObject(i)&&gui.Object.each(i,function(i,e){switch(t+=t.includes("?")?"&":"?",gui.Type.of(e)){case"array":t+=e.map(function(t){return i+"="+String(t)}).join("&");break;default:t+=i+"="+String(e)}}),t},gui.URL.origin=function(t){var i=t.location;return i.origin||i.protocol+"//"+i.host},gui.URL._createLink=function(t,i){var e=t.createElement("a");if(e.href=i||"",gui.Client.isExplorer){var n=gui.URL.parseUri(e.href);Object.keys(n).forEach(function(t){e[t]||(e[t]=n[t])})}return e},gui.URL.parseUri=function(t){for(var i=gui.URL.parseOptions,e=i.parser[i.strictMode?"strict":"loose"].exec(t),n={},r=14;r--;)n[i.key[r]]=e[r]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,function(t,e,r){e&&(n[i.q.name][e]=r)}),n},gui.URL.parseOptions={strictMode:!0,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},gui.Then=function(t,i){t&&this.then(t,i)},gui.Then.prototype={toString:function(){return"[object gui.Then]"},then:function(t,i){this._callback=t?t:null,this._pointer=i?i:null,this._now&&this.now()},now:function(){var t=this._callback,i=this._pointer;t?(this.then(null,null),t.apply(i,arguments)):this._now=!0},_callback:null,_pointer:null,_now:!1},gui.HTMLParser={toString:function(){return"[object gui.HTMLParser]"},parse:function(t,i){return this.parseAll(t,i)[0]||null},parseAll:function(t,i){return this.parseToNodes(t,i).filter(function(t){return t.nodeType===Node.ELEMENT_NODE})},parseToNode:function(t,i){return this.parseToNodes(t,i)[0]||null},parseToNodes:function(t,i){var e,n=this._document||(this._document=document.implementation.createHTMLDocument(""));return gui.Guide.suspend(function(){return n.body.innerHTML=this._unsanitize(t),e=n.querySelector("."+this._classname)||n.body,Array.map(e.childNodes,function(t){return(i||document).importNode(t,!0)})},this)},parseToDocument:function(t){return t=t||"",gui.Guide.suspend(function(){var i=document.implementation.createHTMLDocument("");if(t.toLowerCase().includes("<!doctype"))try{i.documentElement.innerHTML=t}catch(e){i=new ActiveXObject("htmlfile"),i.open(),i.write(t),i.close()}else i.body.innerHTML=t;return i})},_classname:"_gui-htmlparser",_comments:/<!--[\s\S]*?-->/g,_firsttag:/^<([a-z]+)/i,_document:null,_unsanitize:function(t){var i,e;return t=t.trim().replace(this._comments,""),(i=t.match(this._firsttag))&&(e=this._unsanestructures[i[1]])&&(t=e.replace("${class}",this._classname).replace("${markup}",t)),t},_unsanestructures:function(){var t={td:'<table><tbody><tr class="${class}">${markup}</tr></tbody></table>',tr:'<table><tbody class="${class}">${markup}</tbody></table>',tbody:'<table class="${class}">${markup}</table>',col:'<table><colgroup class="${class}">${markup}</colgroup></table>',option:'<select class="${class}"><option>a</option>${markup}</select>'};return t.th=t.td,["thead","tfoot","caption","colgroup"].forEach(function(i){t[i]=t.tbody}),t}()},gui.EventSummary=function(t){this._construct(t)},gui.EventSummary.prototype={event:null,window:null,document:null,documentspirit:null,toString:function(){return"[object gui.EventSummary]"},_construct:function(t){var i=null,e=null,n=t.target,r=n.nodeType;gui.Type.isDefined(r)?(e=r===Node.DOCUMENT_NODE?n:n.ownerDocument,i=e.defaultView):(i=n,e=i.document),this.event=t,this.window=i,this.document=e,this.documentspirit=e.documentElement.spirit}},gui.Crawler=function(t){return gui.Class.create(Object.prototype,{type:null,direction:null,global:!1,toString:function(){return"[object gui.Crawler]"},onconstruct:function(t){this.type=t||null},ascend:function(i,e){this._stopped=!1,this.direction=gui.Crawler.ASCENDING;var n,r=gui.hasModule("gui-spirits@wunderbyte.com"),u=r&&i instanceof gui.Spirit,o=u?i.element:i;do if(o.nodeType===Node.DOCUMENT_NODE&&(this.global?(n=o.defaultView,n.gui.hosted?n.gui.xhost?(o=null,t.isFunction(e.transcend)&&e.transcend(n.parent,n.gui.xhost,n.gui.$contextid)):o=n.frameElement:o=null):o=null),o){var s=this._handleElement(o,e);switch(s){case gui.Crawler.STOP:o=null;break;default:o=o.parentNode}}while(o)},ascendGlobal:function(t,i){this.global=!0,this.ascend(t,i),this.global=!1},descend:function(t,i,e){this._stopped=!1,this.direction=gui.Crawler.DESCENDING;var n=t instanceof gui.Spirit?t.element:t;n.nodeType===Node.DOCUMENT_NODE&&(n=n.documentElement),this._descend(n,i,e,!0)},descendGlobal:function(t,i,e){this.global=!0,this.descend(t,i,e),this.global=!1},_stopped:!1,_descend:function(i,e,n,r){var u,o,s,a=this._handleElement(i,e,n);switch(a){case gui.Crawler.STOP:this._stopped=!0;break;case gui.Crawler.CONTINUE:case gui.Crawler.SKIP_CHILDREN:a!==gui.Crawler.SKIP_CHILDREN&&(i.childElementCount?this._descend(i.firstElementChild,e,n,!1):this.global&&"iframe"===i.localName&&(s=i.spirit)&&s instanceof gui.IframeSpirit&&(u=i.ownerDocument.defaultView,t.isFunction(e.transcend)&&e.transcend(s.contentWindow,s.xguest,s.$instanceid))),this._stopped||!r&&(o=i.nextElementSibling)&&this._descend(o,e,n,!1)}},_handleElement:function(i,e,n){var r,u=gui.hasModule("gui-spirits@wunderbyte.com"),o=gui.Crawler.CONTINUE;return e&&(t.isFunction(e.handleElement)&&(o=e.handleElement(i,n)),!o&&u&&(r=gui.get(i))&&(o=r.oncrawler(this),o||t.isFunction(e.handleSpirit)&&(o=this._handleSpirit(r,e)))),o||(o=gui.Crawler.CONTINUE),o},_handleSpirit:function(t,i){return i.handleSpirit(t)}},{},{ASCENDING:"ascending",DESCENDING:"descending",CONTINUE:0,STOP:1,SKIP:2,SKIP_CHILDREN:4})}(gui.Type),gui.Request=function(t,i){this._headers={Accept:"application/json"},t&&this.url(t,i)},gui.Request.prototype=function(i){return{url:i(function(t,i){this._url=i?new gui.URL(i,t).href:t}),sync:i(function(){this._async=!1}),async:i(function(){this._async=!0}),accept:i(function(t){this._headers.Accept=t}),acceptJSON:i(function(){this.accept("application/json")}),acceptXML:i(function(){this.accept("text/xml")}),acceptText:i(function(){this.accept("text/plain")}),format:i(function(t){this._format=t}),override:i(function(t){this._override=t||!0}),headers:i(function(t){if(!gui.Type.isObject(t))throw new TypeError("Object expected");gui.Object.each(t,function(t,i){this._headers[t]=String(i)},this)}),_async:!0,_url:null,_format:"application/json",_override:!1,_headers:null,_request:function(i,e,n){var r=this,u=new XMLHttpRequest,o=gui.URL.external(this._url,document);o&&t.XDomainRequest&&(u=new t.XDomainRequest),u.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var t=r._response(this.responseText);n(this.status,t,this.responseText)}},this._override&&u.overrideMimeType(this._headers.Accept),u.open(i.toUpperCase(),this._url,!0),o||gui.Object.each(this._headers,function(t,i){u.setRequestHeader(t,i,!1)}),u.send(e)},_response:function(t){var i=t;try{switch(this._headers.Accept){case"application/json":i=JSON.parse(t);break;case"text/xml":i=(new DOMParser).parseFromString(t,"text/xml")}}catch(e){gui.debug&&console.error(this._headers.Accept+" dysfunction at "+this._url)}return i}}}(gui.Combo.chained),["get","post","put","delete"].forEach(function(t){gui.Request.prototype[t]=function(i){if(gui.Type.isFunction(i))throw new Error("Deprecated: gui.Request returns a gui.Then");var e=new gui.Then;return i="get"===t?null:i,this._request(t,i,function(t,i,n){e.now(t,i,n)}),e}}),gui.Client=function(){function i(t){var i=document.documentElement,e=t[0].toUpperCase()+t.substring(1);return!["","Webkit","Moz","O","ms"].every(function(n){return void 0===i.style[n?n+e:t]})}function e(){this.isExplorer=n.includes("msie")||n.includes("trident"),this.isExplorer9=this.isExplorer&&n.includes("msie 9"),this.isExplorer10=this.isExplorer&&n.includes("msie 10"),this.isExplorer11=this.isExplorer&&n.includes("rv:11"),this.isWebKit=n.includes("webkit")||n.includes("opera"),this.isChrome=this.isWebKit&&n.includes("chrome"),this.isSafari=this.isWebKit&&!this.isChrome&&n.includes("safari"),this.isBlink=n.includes("blink"),this.isGecko=!this.isExplorer&&!this.isWebKit&&!this.isOpera&&n.includes("gecko"),this.isChromeApp=t.chrome&&t.chrome.app&&t.chrome.app.runtime?!0:!1,this.agent=function(){var t="explorer";return this.isWebKit?t="webkit":this.isGecko?t="gecko":this.isOpera&&(t="opera"),t}.call(this),this.system=function(t){var i=null;return t.every(function(t){return n.includes(t)&&(i=t.match(/ipad|iphone/)?"ios":t.replace(/ /g,"")),null===i}),i}(["window mobile","windows","ipad","iphone","os x","linux","haiku","amiga"]),this.hasTouch=void 0!==t.ontouchstart||this.isChrome,this.hasPointers=!1,this.hasBlob=t.Blob&&(t.URL||t.webkitURL),this.hasHistory=t.history&&t.history.pushState?!0:!1,this.isTouchDevice=function(t){return t.some(function(t){return n.includes(t)})}(["android","webos","iphone","ipad","ipod","blackberry","windows phone"]),this.hasTransitions=i("transition"),this.hasTransforms=i("transform"),this.hasAnimations=i("animationName"),this.has3D=i("perspective"),this.hasFlex=i("flex"),this.hasProxies=t.Proxy&&t.Proxy.create,this.hasPerformance=t.performance&&t.performance.now,Object.defineProperty(this,"hasFlexBox",{get:function(){console.error("Depracated API is deprecated: hasFlexBox >> hasFlex")}}),this.hasAnimationFrame=function(){var i=t;return i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.msRequestAnimationFrame||i.oRequestAnimationFrame?!0:!1}(),this.hasTemplates=function(t){return"content"in t?!0:!1}(document.createElement("template")),this.hasImports=function(t){return"import"in t?!0:!1}(document.createElement("link")),this.hasMutations=function(){return!["","WebKit","Moz","O","Ms"].every(function(i){return!gui.Type.isDefined(t[i+"MutationObserver"])})}(),this.scrollRoot=null,this.scrollBarSize=0,this.hasPositionFixed=!1}var n=navigator.userAgent.toLowerCase();return new e}(),Object.defineProperty(gui.Client,"isMobile",{get:function(){console.error("Deprecated API is deprecated: gui.Client.isMobile (use isTouchDevice)")}}),document.addEventListener("DOMContentLoaded",function(){if(gui.CSSPlugin){var i=t,e=document,n=e.documentElement,r=e.body,u=null,o=r.appendChild(gui.CSSPlugin.style(e.createElement("div"),{position:"absolute",height:"10px",width:"10px",top:"100%"}));i.scrollBy(0,10),u=n.scrollTop?n:r,gui.Client.scrollRoot=u,gui.CSSPlugin.style(o,{position:"fixed",top:"10px"});var s=10===o.getBoundingClientRect().top;gui.Client.hasPositionFixed=s,r.removeChild(o),i.scrollBy(0,-10);var a=gui.CSSPlugin.style(document.createElement("p"),{width:"100%",height:"200px"}),c=gui.CSSPlugin.style(document.createElement("div"),{position:"absolute",top:"0",left:"0",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"});c.appendChild(a),n.appendChild(c);var l=a.offsetWidth;c.style.overflow="scroll";var h=a.offsetWidth;l===h&&(h=c.clientWidth),n.removeChild(c),gui.Client.scrollBarSize=l-h,gui.Client.isExplorer&&(gui.Client.scrollBarSize=17)}}),gui.MapList=function(t,i){function e(t){this._map=Object.create(null),this._fit=t||null}return e.prototype={get:function(t){return this._map[t]},set:t("string","array")(function(t,i){return this._map[t]=i}),has:function(t){return void 0!==this._map[t]},"delete":function(t){this._map[t]=null,delete this._map[t]},add:t("string")(function(t,i){var e=this.get(t)||this.set(t,[]),n=-1===e.indexOf(i);if(n){if(this._fit&&!(i instanceof this._fit))throw new TypeError(i+" is not a "+this._fit);e.push(i)}return n}),remove:t("string")(function(t,e){var n,r=this.get(t);r&&(n=i.remove(r,e),0===n&&this["delete"](t))}),each:function(t,i){gui.Object.each(this._map,function(e,n){t.call(i,e,n)})},_map:null,_fit:null},e}(gui.Arguments.confirmed,gui.Array),gui.module("gui@wunderbyte.com"),gui=gui.Object.extend(gui,{mode:"robot",MODE_ROBOT:"robot",MODE_HUMAN:"human",MODE_FUNNY:"funny",autostart:!0,BROADCAST_KICKSTART:"gui-broadcast-kickstart",BROADCAST_WILL_SPIRITUALIZE:"gui-broadcast-will-spiritualize",BROADCAST_DID_SPIRITUALIZE:"gui-broadcast-did-spiritualize",ACTION_DOC_ONSPIRITUALIZED:"gui-action-document-spiritualized",$ACTION_XFRAME_VISIBILITY:"gui-action-xframe-visibility",LIFE_CONSTRUCT:"gui-life-construct",LIFE_CONFIGURE:"gui-life-configure",LIFE_ENTER:"gui-life-enter",LIFE_ATTACH:"gui-life-attach",LIFE_READY:"gui-life-ready",LIFE_DETACH:"gui-life-detach",LIFE_EXIT:"gui-life-exit",LIFE_ASYNC:"gui-life-async",LIFE_DESTRUCT:"gui-life-destruct",LIFE_VISIBLE:"gui-life-visible",LIFE_INVISIBLE:"gui-life-invisible",LIFE_RENDER:"gui-life-render",LIFE_IFRAME_CONSTRUCT:"gui-life-iframe-construct",LIFE_IFRAME_DOMCONTENT:"gui-life-iframe-domcontent",LIFE_IFRAME_SPIRITUALIZED:"gui-life-iframe-spiritualized",LIFE_IFRAME_ONLOAD:"gui-life-iframe-onload",LIFE_IFRAME_ONHASH:"gui-life-iframe-onhash",LIFE_IFRAME_UNLOAD:"gui-life-iframe-unload",$TICK_INSIDE:"gui-tick-spirits-inside",$TICK_OUTSIDE:"gui-tick-spirits-outside",CRAWLER_SPIRITUALIZE:"gui-crawler-spiritualize",CRAWLER_MATERIALIZE:"gui-crawler-materialize",CRAWLER_DETACH:"gui-crawler-detach",CRAWLER_DISPOSE:"gui-crawler-dispose",CRAWLER_ACTION:"gui-crawler-action",CRAWLER_VISIBLE:"gui-crawler-visible",CRAWLER_INVISIBLE:"gui-crawler-invisible",CRAWLER_REFLEX:"gui-crawler-reflex",CLASS_NOSPIRITS:"gui-nospirits",CLASS_INVISIBLE:"_gui-invisible",CLASS_HIDDEN:"_gui-hidden",spiritualized:!1,attributes:null,spiritualize:function(t){gui.Guide.$spiritualize(t||document)},spiritualizeSub:function(t){gui.Guide.$spiritualizeSub(t||document)},spiritualizeOne:function(t){gui.Guide.$spiritualizeOne(t||document)},materialize:function(t,i){gui.Guide.$materialize(t||document,i)},materializeSub:function(t){gui.Guide.$materializeSub(t||document)},materializeOne:function(t){gui.Guide.$materializeOne(t||document)},suspend:function(t){return gui.DOMObserver.suspend(function(){return gui.Guide.suspend(t)})},get:function(t){var i,e,n=document;switch(gui.Type.of(t)){case"string":if(gui.KeyMaster.isKey(t)&&(i=gui.Guide.$getSpiritById(t)),!i)try{e=n.querySelector(t)||n.querySelector("#"+t)}catch(r){}finally{i=e?e.spirit:null}break;case"function":var u,o=this._spirits.inside;gui.Type.isSpiritConstructor(t)&&Object.keys(this._spirits.inside).some(function(e){return(u=o[e]).constructor===t?(i=u,!0):void 0});break;default:if(!gui.Type.isElement(t))throw new TypeError("gui.get("+t+")");i=t.spirit||null}return i||null},getAll:function(t){console.error("TODO: gui.getAll")},channel:function(){gui.Guide.$channel.apply(gui.Guide,arguments)},hasChannels:function(){return gui.Guide.$hasChannels()},getChannels:function(){return gui.Guide.$getChannels()},ready:function(t,i){var e=this.spiritualized;return arguments.length&&(e?t.call(i):(this._readycallbacks=this._readycallbacks||[],this._readycallbacks.push(function(){if(gui.debug)try{t.call(i)}catch(e){throw console.error(t.toString()),e}else t.call(i)}))),e},_readycallbacks:null,_initspirits:function(){return this.attributes=["gui"],gui.Broadcast.add(gui.BROADCAST_TODOM,{onbroadcast:function(){gui.Guide.$startGuiding(),gui._nowready()}}),this},_nowready:function(){this.spiritualized=!0;var t=this._readycallbacks;if(t){for(;t.length;)t.shift()();this._readycallbacks=null}}}._initspirits()),gui.ActionPlugin=function(t,i){return gui.TrackerPlugin.extend({type:null,data:null,add:t("array|string","(object|function)")(i(function(t,i){i=i?i:this.spirit,gui.Interface.validate(gui.Action.IActionHandler,i)&&gui.Array.make(t).forEach(function(t){this._addchecks(t,[i,this._global])},this)})),remove:t("array|string","(object|function)")(i(function(t,i){i=i?i:this.spirit,gui.Interface.validate(gui.Action.IActionHandler,i)&&gui.Array.make(t).forEach(function(t){this._removechecks(t,[i,this._global])},this)})),addGlobal:function(t,i){return this._globalize(function(){return this.add(t,i)})},removeGlobal:function(t,i){return this._globalize(function(){return this.remove(t,i)})},dispatch:t("string","(*)")(function(t,i){return gui.Action.dispatch(this.spirit,t,i)}),ascend:t("string","(*)")(function(t,i){return gui.Action.ascend(this.spirit,t,i)}),descend:t("string","(*)")(function(t,i){return gui.Action.descend(this.spirit,t,i)}),dispatchGlobal:t("string","(*)")(function(t,i){return gui.Action.dispatchGlobal(this.spirit,t,i)}),ascendGlobal:t("string","(*)")(function(t,i){return gui.Action.ascendGlobal(this.spirit,t,i)}),descendGlobal:t("string","(*)")(function(t,i){return gui.Action.descendGlobal(this.spirit,t,i)}),_cleanup:function(t,i){var e=i[0],n=i[1];n?this.removeGlobal(t,e):this.remove(t,e)},$handleownaction:!1,$onaction:function(t){var i=this._trackedtypes[t.type];i&&i.forEach(function(i){var e=i[0],n=i[1]===t.global,r=e===this.spirit&&this.$handleownaction;n&&(e!==t.target||r)&&e.onaction(t)},this)}})}(gui.Arguments.confirmed,gui.Combo.chained),gui.BroadcastPlugin=function(t,i){return gui.TrackerPlugin.extend({add:i("string|array")(t(function(t,i){i=i?i:this.spirit;var e=this._global?null:this._sig;gui.Array.make(t).forEach(function(t){this._addchecks(t,[i,this._global])&&(this._global?gui.Broadcast.addGlobal(t,i):gui.Broadcast.add(t,i,e))},this)})),remove:i("string|array")(t(function(t,i){i=i?i:this.spirit;var e=this._global?null:this._sig;gui.Array.make(t).forEach(function(t){this._removechecks(t,[i,this._global])&&(this._global?gui.Broadcast.removeGlobal(t,i):gui.Broadcast.remove(t,i,e))},this)})),dispatch:i("string|array")(function(t,i){var e=null,n=this._global,r=n?null:this._sig;return this._global=!1,gui.Array.make(t).forEach(function(t){gui.Broadcast.$target=this.spirit,e=n?gui.Broadcast.dispatchGlobal(t,i):gui.Broadcast.dispatch(t,i,r)},this),e}),addGlobal:function(t,i){return this._globalize(function(){return this.add(t,i)})},removeGlobal:function(t,i){return this._globalize(function(){return this.remove(t,i)})},shiftGlobal:function(t,i,e){return this._globalize(function(){return this.shift(t,i,e)})},dispatchGlobal:function(t,i){return this._globalize(function(){return this.dispatch(t,i)})},_cleanup:function(t,i){var e=i[0],n=i[1];n?gui.Broadcast.removeGlobal(t,e):gui.Broadcast.remove(t,e,this._sig)}})}(gui.Combo.chained,gui.Arguments.confirmed),gui.TickPlugin=function(t,i){return gui.TrackerPlugin.extend({add:t(function(t,e,n){e=e?e:this.spirit,gui.Interface.validate(gui.ITickHandler,e)&&i.make(t).forEach(function(t){this._addchecks(t,[e,this._global])&&this._add(t,e,!1)},this)}),remove:t(function(t,e){e=e?e:this.spirit,gui.Interface.validate(gui.ITickHandler,e)&&i.make(t).forEach(function(t){this._removechecks(t,[e,this._global])&&this._remove(t,e)},this)}),one:t(function(t,i){this.add(t,i,!0)}),next:t(function(t,i){gui.Tick.next(t,i||this.spirit)}),nextFrame:function(t,i){return gui.Tick.nextFrame(t,i||this.spirit)},cancelFrame:t(function(t){gui.Tick.cancelFrame(t)}),time:function(t,i,e){return gui.Tick.time(t,i,e||this.spirit)},cancelTime:t(function(t){gui.Tick.cancelTime(t)}),start:t(function(t){gui.Tick.start(t)}),stop:t(function(t){gui.Tick.stop(t)}),dispatch:function(t,i){return this._dispatch(t,i||0)},_global:!1,_add:function(t,i,e){var n=this.spirit.$contextid;e?this._global?gui.Tick.oneGlobal(t,i):gui.Tick.one(t,i,n):this._global?gui.Tick.addGlobal(t,i):gui.Tick.add(t,i,n)},_remove:function(t,i){var e=this.spirit.$contextid;this._global?gui.Tick.removeGlobal(t,i):gui.Tick.remove(t,i,e)},_dispatch:function(t,i){var e,n=this.spirit.$contextid;return e=this._global?gui.Tick.dispatchGlobal(t,i):gui.Tick.dispatch(t,i,n)},_cleanup:function(t,i){var e=i[0],n=i[1];this._remove(t,[e])&&(n?gui.Tick.removeGlobal(t,e):gui.Tick.remove(t,e,this.$contextid))}})}(gui.Combo.chained,gui.Array),gui.ITickHandler={toString:function(){return"[object ITickHandler]"},ontick:function(t){}},gui.Life=function(t,i){this.target=t,this.type=i},gui.Life.prototype={target:null,type:null,toString:function(){return"[object gui.Life]"}},gui.LifePlugin=gui.TrackerPlugin.extend({constructed:!1,configured:!1,entered:!1,attached:!1,detached:!0,ready:!1,async:!1,exited:!1,destructed:!1,visible:void 0,rendered:!1,plugins:null,onconstruct:function(){gui.TrackerPlugin.prototype.onconstruct.call(this),this._handlers=Object.create(null),this.plugins=Object.create(null)},add:function(t,i){return i=i?i:this.spirit,gui.Array.make(t).forEach(function(t){this._addchecks(t,[i])&&(this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(i))},this),this.spirit},remove:function(t,i){return i=i?i:this.spirit,gui.Array.make(t).forEach(function(t){if(this._removechecks(t,[i])&&this._handlers[t]){var e=this._handlers[t].indexOf(t);gui.Array.remove(this._handlers[t],e),0===this._handlers[t].length&&delete this._handlers[t]}},this),this.spirit},dispatch:function(t){var i=this._handlers[t];if(i){var e=new gui.Life(this.spirit,t);switch(i.forEach(function(t){t.onlife(e)}),t){case gui.LIFE_CONSTRUCT:case gui.LIFE_CONFIGURE:case gui.LIFE_ENTER:case gui.LIFE_READY:case gui.LIFE_DETACH:case gui.LIFE_EXIT:case gui.LIFE_DESTRUCT:delete this._handlers[t]}}},_handlers:null,_cleanup:function(t,i){var e=i[0];this.remove(t,e)}}),gui.ConfigPlugin=gui.Plugin.extend({configureall:function(){var t=this.spirit.element.attributes;Array.forEach(t,function(t){this.configureone(t.name,t.value)},this)},onlife:function(t){var i;if(t.type===gui.LIFE_READY)for(;i=this._onready.shift();)i.action()},configureone:function(t,i){var e,n=this.spirit.window.gui,r=gui.ConfigPlugin.SEPARATOR;n.attributes.every(function(n){return(e=t.startsWith(n+r))&&this._evaluate(t,i,n,r),!e},this)},_onready:null,_evaluate:function(t,i,e,n){var r=this.spirit,u=!0,o=null,s=null;t=o=t.split(e+n)[1],t.indexOf(n)>-1&&(s=t.split(n),s.forEach(function(t,i){gui.Type.isDefined(r)?i<s.length-1?r=r[t]:o=t:u=!1})),u&&gui.Type.isDefined(r[o])?this._schedule(r,o,this._revaluate(i)):console.error('No definition for "'+t+'" in '+this.spirit.toString())},_schedule:function(t,i,e){if(gui.Type.isFunction(t[i]))if(this.spirit.life.ready)t[i](e);else{if(this.spirit.life.add(gui.LIFE_READY,this),this._onready){this._onready.reduce(function(e,n,r){return n.struct===t&&n.prop===i?r:e},-1)}else this._onready=[];this._onready.push({struct:t,prop:i,action:function(){t[i](e)}})}else t[i]=e},_revaluate:function(i){return gui.Type.isString(i)&&(gui.hasModule("edbml@wunderbyte.com")&&i.startsWith("edbml.$get")?i=t.edbml.$get(gui.KeyMaster.extractKey(i)[0]):(i=gui.Type.cast(i),gui.Type.isString(i)&&(i=this._jsonvaluate(i)))),i},_jsonvaluate:function(t){if([["%5B","%5D"],["%7B","%7D"]].some(function(i){return t.startsWith(i[0])&&t.endsWith(i[1])}))try{t=JSON.parse(decodeURIComponent(t))}catch(i){t=null,console.error(this+": Bad JSON: "+i.message)}return t}},{lazy:!1,SEPARATOR:"."}),gui.Att=function(t,i){this.value=gui.Type.cast(i),this.name=this.type=t},gui.Att.prototype={name:null,type:null,value:null},gui.AttPlugin=function(t,i){return gui.TrackerPlugin.extend({get:function(t){return gui.AttPlugin.get(this.spirit.element,t)},set:i(function(t,i){this.$suspended||gui.AttPlugin.set(this.spirit.element,t,i)}),has:function(t){return gui.AttPlugin.has(this.spirit.element,t)},del:i(function(t){this.$suspended||gui.AttPlugin.del(this.spirit.element,t)}),all:function(){return gui.AttPlugin.all(this.spirit.element)},shift:t("boolean","string")(i(function(t,i,e){if(t){if(void 0===e)throw new TypeError('Missing value for "'+i+'"');this.set(i,e)}else this.del(i)})),getmap:function(){return gui.AttPlugin.getmap(this.spirit.element)},setmap:function(t){gui.AttPlugin.setmap(this.spirit.element,t)},add:t("array|string","(object|function)")(i(function(t,i){i=i?i:this.spirit,gui.Interface.validate(gui.IAttHandler,i)&&gui.Array.make(t).forEach(function(t){this._addchecks(t,[i]),this._onadd(t)},this)})),remove:t("array|string","(object|function)")(i(function(t,i){i=i?i:this.spirit,gui.Interface.validate(gui.IAttHandler,i)&&gui.Array.make(t).forEach(function(t){this._removechecks(t,[i])},this)})),$suspended:!1,$suspend:function(t){this.$suspended=!0;var i=t();return this.$suspended=!1,i},$onatt:function(t,i){var e,n,r,u,o=!gui.attributes.every(function(e){return(u=t.startsWith(e))&&this.spirit.config.configureone(t,i),!u},this);!o&&(e=this._trackedtypes[t])&&(n=new gui.Att(t,i),e.forEach(function(t){r=t[0],r.onatt(n)},this))},_onadd:function(t){if(this.has(t)){var i=this.get(t);t.startsWith(gui.ConfigPlugin.PREFIX)?this.spirit.config.configureone(t,i):this.$onatt(t,i)}}},{},{get:function(t,i){return gui.Type.cast(t.getAttribute(i))},set:i(function(t,i,e){var n=t.spirit,r=!1;this._ischecked(t,i)?(r=t.checked!==e,t.checked="false"===String(e)?!1:null!==e,r&&n.att.$onatt(i,e)):this._isvalue(t,i)?(r=t.value!==String(e),r&&(t.value=String(e),n.att.$onatt(i,e))):null===e?this.del(t,i):(e=String(e),t.getAttribute(i)!==e&&(n?(n.att.$suspend(function(){t.setAttribute(i,e)}),n.att.$onatt(i,e)):t.setAttribute(i,e)))}),_ischecked:function(t,i){return t.type&&void 0!==t.checked&&"checked"===i},_isvalue:function(t,i){return void 0!==t.value&&"value"===i},has:function(t,i){return t.hasAttribute(i)},del:i(function(t,i){var e=t.spirit;this._ischecked(t,i)?t.checked=!1:this._isvalue(t,i)?t.value="":e?(e.att.$suspend(function(){t.removeAttribute(i)}),e.config.configureone(i,null)||e.att.$onatt(i,null)):t.removeAttribute(i)}),all:function(t){return gui.Array.from(t.attributes)},getmap:function(t){var i=Object.create(null);return this.all(t).forEach(function(t){
i[t.name]=gui.Type.cast(t.value)}),i},setmap:i(function(t,i){gui.Object.each(i,function(i,e){this.set(t,i,e)},this)})})}(gui.Arguments.confirmed,gui.Combo.chained),gui.IAttHandler={toString:function(){return"[object IAttHandler]"},onatt:function(t){}},gui.BoxPlugin=gui.Plugin.extend({width:0,height:0,localX:0,localY:0,pageX:0,pageY:0,clientX:0,clientY:0,_scrollroot:function(){return function(t){return"html"===gui.Client.scrollRoot.localName?t.documentElement:t.body}(this.spirit.document)}}),Object.defineProperties(gui.BoxPlugin.prototype,{width:{get:function(){return this.spirit.element.offsetWidth}},height:{get:function(){return this.spirit.element.offsetHeight}},localX:{get:function(){return this.spirit.element.offsetLeft}},localY:{get:function(){return this.spirit.element.offsetTop}},pageX:{get:function(){return this.clientX+this._scrollroot().scrollLeft}},pageY:{get:function(){return this.clientY+this._scrollroot().scrollTop}},clientX:{get:function(){return this.spirit.element.getBoundingClientRect().left}},clientY:{get:function(){return this.spirit.element.getBoundingClientRect().top}}}),gui.CSSPlugin=function(i,e){return gui.Plugin.extend({add:e("string|array")(i(function(t){var i=this.spirit.element;gui.Array.make(t).forEach(function(t){gui.CSSPlugin.add(i,t)})})),remove:e("string|array")(i(function(t){var i=this.spirit.element;gui.Array.make(t).forEach(function(t){gui.CSSPlugin.remove(i,t)})})),toggle:e("string|array")(i(function(t){var i=this.spirit.element;gui.Array.make(t).forEach(function(t){gui.CSSPlugin.toggle(i,t)})})),shift:e("*","string|array")(i(function(t,i){var e=this.spirit.element;gui.Array.make(i).forEach(function(i){gui.CSSPlugin.shift(e,t,i)})})),contains:e("string")(function(t){return gui.CSSPlugin.contains(this.spirit.element,t)}),set:i(function(t,i){gui.CSSPlugin.set(this.spirit.element,t,i)}),style:i(function(t){gui.CSSPlugin.style(this.spirit.element,t)}),get:function(t){return gui.CSSPlugin.get(this.spirit.element,t)},compute:function(t){return gui.CSSPlugin.compute(this.spirit.element,t)},name:i(function(t){var i=this.spirit.element.className;return void 0!==t&&(this.spirit.element.className=t,i=this.spirit),i}),matches:function(t){return gui.CSSPlugin.matches(this.spirit.element,t)}},{},{add:i(function(t,i){if(gui.Type.isString(i))if(i.indexOf(" ")>-1&&(i=i.split(" ")),gui.Type.isArray(i))i.forEach(function(i){this.add(t,i)},this);else if(this._supports)t.classList.add(i);else{var e=t.className.split(" ");-1===e.indexOf(i)&&(e.push(i),t.className=e.join(" "))}}),remove:i(function(t,i){if(gui.Type.isString(i))if(i=i||"",i.indexOf(" ")>-1&&(i=i.split(" ")),gui.Type.isArray(i))i.forEach(function(i){this.remove(t,i)},this);else if(this._supports)t.classList.remove(i);else{var e=t.className.split(" "),n=e.indexOf(i);n>-1&&gui.Array.remove(e,n),t.className=e.join(" ")}}),toggle:i(function(t,i){gui.Type.isString(i)&&(this._supports?t.classList.toggle(i):this.contains(t,i)?this.remove(t,i):this.add(t,i))}),shift:i(function(t,i,e){i?this.add(t,e):this.remove(t,e)}),contains:function(t,i){if(this._supports)return t.classList.contains(i);var e=t.className.split(" ");return e.indexOf(i)>-1},set:i(function(t,i,e){gui.Type.isNumber(e)&&(e=(this._shorthands[i]||"@").replace("@",e)),e=String(e),"float"===i?i="cssFloat":(e=this._jsvalue(e),i=this._jsproperty(i)),t.style[i]=e}),get:function(t,i){return i=this._jsproperty(i),this._jsvalue(t.style[i])},style:function(t,i){var e=t instanceof gui.Spirit?t.element:t;return gui.Object.each(i,function(t,i){this.set(e,t,i)},this),t},compute:function(i,e){var n=i instanceof gui.Spirit?i.element:i;return e=this._standardcase(this._jsproperty(e)),t.getComputedStyle(n,null).getPropertyValue(e)},matches:function(t,i){var e=!1;try{e=t[this._matchmethod](i)}catch(n){throw console.error('Invalid selector: "'+i+'"'),n}return e},_vendors:["","-webkit-","-moz-","-ms-","-o-"],_supports:void 0!==document.documentElement.classList,_camelcase:function(t){return t.replace(/-([a-z])/gi,function(t,i){return i.toUpperCase()})},_standardcase:function(t){return t.replace(/[A-Z]/g,function(i,e){return"-"+t.charAt(e).toLowerCase()})},_jsproperty:function(t){var i=this._vendors,e=t,n=document.documentElement;return t=String(t),t.startsWith("-beta-")?i.every(function(i){var r=this._camelcase(t.replace("-beta-",i));return void 0!==n.style[r]?(e=r,!1):!0},this):e=this._camelcase(e),e},_jsvalue:function(t){var i=this._vendors,e=document.documentElement;if(t=String(t),t&&t.includes("-beta-")){var n=[];t.split(", ").forEach(function(t){(t=t.trim()).startsWith("-beta-")?i.every(function(i){var r=this._camelcase(t.replace("-beta-",i));return void 0!==e.style[r]?(n.push(t.replace("-beta-",i)),!1):!0},this):n.push(t)},this),t=n.join(",")}return t},_cssproperty:function(t){return this._standardcase(this._jsproperty(t))},_cssvalue:function(t){return this._standardcase(this._jsvalue(t))},_shorthands:{top:"@px",right:"@px",bottom:"@px",left:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",textIndent:"@px",margin:"@px",marginTop:"@px",marginRight:"@px",marginBottom:"@px",marginLeft:"@px",padding:"@px",paddingTop:"@px",paddingRight:"@px",paddingBottom:"@px",paddingLeft:"@px",fontWeight:"@",opacity:"@",zIndex:"@",position:"@",display:"@",visibility:"@"},_matchmethod:function(){var t=null,i=document.documentElement;return["mozMatchesSelector","webkitMatchesSelector","msMatchesSelector","oMatchesSelector","matchesSelector"].every(function(e){return gui.Type.isDefined(i[e])&&(t=e),null===t}),t}()})}(gui.Combo.chained,gui.Arguments.confirmed),function(){function t(t){Object.defineProperty(gui.CSSPlugin.prototype,t,{enumerable:!0,configurable:!0,get:function(){return this.spirit?parseInt(this.get(t),10):void 0},set:function(i){this.set(t,i)}})}var i=gui.CSSPlugin._shorthands;for(var e in i)i.hasOwnProperty(e)&&t(e)}(),gui.DOMPlugin=function(t,i,e){return gui.Plugin.extend({id:t(function(t){return t?void(this.spirit.element.id=t):this.spirit.element.id||null}),title:t(function(t){var i=this.spirit.element;return gui.Type.isDefined(t)?void(i.title=t?t:""):i.title}),html:t(function(t,i){return gui.DOMPlugin.html(this.spirit.element,t,i)}),outerHtml:t(function(t){return gui.DOMPlugin.outerHtml(this.spirit.element,t)}),text:t(function(t){return gui.DOMPlugin.text(this.spirit.element,t)}),empty:t(function(){this.html("")}),hide:t(function(){this.spirit.css.contains(gui.CLASS_HIDDEN)||(this.spirit.css.add(gui.CLASS_HIDDEN),gui.hasModule("gui-layout@wunderbyte.com")&&this.spirit.visibility&&this.spirit.visibility.off())}),show:t(function(){this.spirit.css.contains(gui.CLASS_HIDDEN)&&(this.spirit.css.remove(gui.CLASS_HIDDEN),gui.hasModule("gui-layout@wunderbyte.com")&&this.spirit.visibility&&this.spirit.visibility.on())}),tag:function(){return this.spirit.element.localName},embedded:function(){return gui.DOMPlugin.embedded(this.spirit.element)},remove:function(){var t=this.spirit.element.parentNode;t.removeChild(this.spirit.element)},clone:function(){return this.spirit.element.cloneNode(!0)},ordinal:function(){return gui.DOMPlugin.ordinal(this.spirit.element)},compare:function(t){return gui.DOMPlugin.compare(this.spirit.element,t)},contains:function(t){return gui.DOMPlugin.contains(this.spirit.element,t)},containedBy:function(t){return gui.DOMPlugin.contains(t,this.spirit.element)},parseToNode:function(t){return gui.DOMPlugin.parseToNode(t)},parseToNodes:function(t){return gui.DOMPlugin.parseToNodes(t)}},{},{html:function(t,i,e){return gui.Type.isString(i)?e?t.insertAdjacentHTML(e,i):void(gui.mode===gui.MODE_ROBOT?(gui.materializeSub(t),gui.suspend(function(){t.innerHTML=i}),gui.spiritualizeSub(t)):t.innerHTML=i):t.innerHTML},outerHtml:function(t,i){return gui.Type.isString(i)?void(gui.mode===gui.MODE_ROBOT?(gui.materialize(t),gui.suspend(function(){t.outerHTML=i}),gui.spiritualize(t)):t.outerHTML=i):t.outerHTML},text:function(t,i){var e=gui.Guide;return gui.Type.isString(i)?void(gui.mode===gui.MODE_ROBOT?(e.materializeSub(t),gui.suspend(function(){t.textContent=i})):t.textContent=i):t.textContent},ordinal:function(t){var i=0,e=t.parentNode;if(e)for(var n=e.firstElementChild;n&&n!==t;)n=n.nextElementSibling,i++;return i},compare:function(t,i){return t=t instanceof gui.Spirit?t.element:t,i=i instanceof gui.Spirit?i.element:i,t.compareDocumentPosition(i)},contains:function(t,i){var e=Node.DOCUMENT_POSITION_CONTAINS+Node.DOCUMENT_POSITION_PRECEDING;return this.compare(i,t)===e},follows:function(t,i){return this.compare(i,t)===Node.DOCUMENT_POSITION_FOLLOWING},precedes:function(t,i){return this.compare(i,t)===Node.DOCUMENT_POSITION_PRECEDING},embedded:function(t){return t=t instanceof gui.Spirit?t.element:t,this.contains(t.ownerDocument,t)},group:function(t){function i(t,i){return i.some(function(i){return gui.DOMPlugin.contains(i,t)})}for(var e,n=[];e=t.pop();)i(e,t)||n.push(e);return n},q:function(t,i,e){var n=null;return this._qualify(t,i)(function(t,i){if(e)n=this.qall(t,i,e)[0]||null;else try{n=t.querySelector(i)}catch(r){throw console.error("Dysfunctional selector: "+i),r}return n})},qall:function(t,i,e){var n=[];return this._qualify(t,i)(function(t,i){return n=gui.Array.from(t.querySelectorAll(i)),e&&(n=n.filter(function(t){return t.spirit&&t.spirit instanceof e}).map(function(t){return t.spirit})),n})},qdoc:function(t,i){return this.q(document,t,i)},qdocall:function(t,i){return this.qall(document,t,i)},_qualify:function(t,i,e){var n,r=!0,u=this._thiskeyword;return t.nodeType===Node.ELEMENT_NODE&&u.test(i)&&(r=t.id,n=t.id=t.id||gui.KeyMaster.generateKey(),i=i.replace(u,"#"+n),t=t.ownerDocument),function(e){var n=e.call(gui.DOMPlugin,t,i);return r||(t.id=""),n}},_thiskeyword:/^this|,this/g})}(gui.Combo.chained,gui.Guide,gui.DOMObserver),gui.Object.bindall(gui.DOMPlugin),gui.DOMPlugin.mixin(gui.Object.map({q:function(t,i){return gui.DOMPlugin.q(this.spirit.element,t,i)},qall:function(t,i){return gui.DOMPlugin.qall(this.spirit.element,t,i)},qdoc:function(t,i){return gui.DOMPlugin.qdoc(t,i)},qdocall:function(t,i){return gui.DOMPlugin.qdocall(t,i)}},function(t,i){return function(){var e=arguments[0],n=arguments[1];if(gui.Type.isString(e)){if(1===arguments.length||gui.Type.isFunction(n))return i.apply(this,arguments);throw n=gui.Type.of(n),new TypeError("Unknown spirit for query: "+t+"("+e+","+n+")")}throw new TypeError("Bad selector for query: "+t+"("+e+")")}})),gui.DOMPlugin.mixin(gui.Object.map({next:function(t){var i=null,e=null,n=this.spirit.element;if(t){for(;null!==(n=n.nextElementSibling);)if(e=n.spirit,null!==e&&e instanceof t){i=e;break}}else i=n.nextElementSibling;return i},previous:function(t){var i=null,e=null,n=this.spirit.element;if(t){for(;null!==(n=n.previousElementSibling);)if(e=n.spirit,null!==e&&e instanceof t){i=e;break}}else i=n.previousElementSibling;return i},first:function(t){var i=null,e=null,n=this.spirit.element.firstElementChild;if(t)for(;null===i&&null!==n;)e=n.spirit,null!==e&&e instanceof t&&(i=e),n=n.nextElementSibling;else i=n;return i},last:function(t){var i=null,e=null,n=this.spirit.element.lastElementChild;if(t)for(;null===i&&null!==n;)e=n.spirit,null!==e&&e instanceof t&&(i=e),n=n.previoustElementSibling;else i=n;return i},parent:function(t){var i=this.spirit.element.parentNode;if(t){var e=i.spirit;i=e&&e instanceof t?e:null}return i},child:function(t){var i=this.spirit.element.firstElementChild;return t&&(i=this.children(t)[0]||null),i},children:function(t){var i=gui.Array.from(this.spirit.element.children);return t&&(i=i.filter(function(i){return i.spirit&&i.spirit instanceof t}).map(function(t){return t.spirit})),i},ancestor:function(t){var i=this.parent();return t&&(i=null,(new gui.Crawler).ascend(this.spirit.element,{handleSpirit:function(e){return e instanceof t?(i=e,gui.Crawler.STOP):void 0}})),i},ancestors:function(t){var i=[],e=new gui.Crawler;return t?e.ascend(this.element,{handleSpirit:function(e){e instanceof t&&i.push(e)}}):e.ascend(this.element,{handleElement:function(t){i.push(t)}}),i},descendant:function(t){var i=this.child(),e=this.spirit.element;return t&&(new gui.Crawler).descend(e,{handleSpirit:function(n){return n instanceof t&&n.element!==e?(i=n,gui.Crawler.STOP):void 0}}),i},descendants:function(t){var i=[],e=this.spirit.element;return(new gui.Crawler).descend(e,{handleElement:function(n){t||n===e||i.push(n)},handleSpirit:function(n){t&&n instanceof t&&n.element!==e&&i.push(n)}}),i},following:function(t){for(var i,e=[],n=this.spirit.element;n=n.nextElementSibling;)t&&(i=n.spirit)?i instanceof t&&e.push(i):e.push(n);return e},preceding:function(t){for(var i,e=[],n=this.spirit.element;n=n.previousElementSibling;)t&&(i=n.spirit)?i instanceof t&&e.push(i):e.push(n);return e},siblings:function(t){return this.preceding(t).concat(this.following(t))}},function(t,i){return function(e){if(!gui.Type.isDefined(e)||gui.Type.isFunction(e))return i.apply(this,arguments);throw new TypeError("Unknown spirit for query: "+t+"("+gui.Type.of(e)+")")}})),function(){function t(t){gui.mode!==gui.MODE_ROBOT&&gui.spiritualize(t)}gui.DOMPlugin.mixin({appendTo:function(i){var e=this.spirit.element;return gui.Type.isSpirit(i)?i.dom.append(e):gui.Type.isElement(i)&&(i.appendChild(e),t(i)),this},parseToNode:function(t,i){return gui.HTMLParser.parseToNode(t,i)},parseToNodes:function(t,i){return gui.HTMLParser.parseToNodes(t,i)}})}(),function(){function t(t){gui.mode!==gui.MODE_ROBOT&&gui.spiritualize(t)}gui.DOMPlugin.mixin(gui.Object.map({append:function(i){var e=i,n=this.spirit.element;e.forEach(function(i){n.appendChild(i),t(i)})},prepend:function(i){var e=i,n=this.spirit.element,r=n.firstChild;e.reverse().forEach(function(i){n.insertBefore(i,r),t(i)})},before:function(i){var e=i,n=this.spirit.element,r=n.parentNode;e.reverse().forEach(function(i){r.insertBefore(i,n),t(i)})},after:function(i){var e=i,n=this.spirit.element,r=n.parentNode;e.forEach(function(i){r.insertBefore(i,n.nextSibling),t(i)})},replace:function(t){this.after(t),this.remove()}},function(t,i){return function(t){var e=Array.map(gui.Array.make(t),function(t){return t&&t instanceof gui.Spirit?t.element:t}).filter(function(t){return t&&gui.Type.isNumber(t.nodeType)});return e.length&&i.call(this,e),t}}))}(),gui.EventPlugin=function(i,e,n,r,u){return gui.TrackerPlugin.extend({add:i(function(t,i,e,n){if(i=this._getelementtarget(i),!i.nodeType&&!u.isWindow(i))throw new TypeError("Invalid target: "+i+" ("+this.spirit.$classname+")");if(e=e?e:this.spirit,n=n?n:!1,r.validate(gui.IEventHandler,e)){var o=[i,e,n];this._breakdown(t).forEach(function(t){this._addchecks(t,o)&&this._shiftEventListener(!0,i,t,e,n)},this)}}),remove:i(function(t,i,e,n){if(i=this._getelementtarget(i),!i.nodeType&&!u.isWindow(i))throw new TypeError("Invalid target: "+i+" ("+this.spirit.$classname+")");if(e=e?e:this.spirit,n=n?n:!1,r.validate(gui.IEventHandler,e)){var o=[i,e,n];this._breakdown(t).forEach(function(t){this._removechecks(t,o)&&this._shiftEventListener(!1,i,t,e,n)},this)}}),toggle:i(function(t,i,n,r){i=this._getelementtarget(i),n=n?n:this.spirit,r=r?r:!1,i instanceof gui.Spirit&&(i=i.element);var u=[i,n,r];e.make(t).forEach(function(t){this._contains(t,u)?this.add(t,i,n,r):this.remove(t,i,n,r)},this)}),dispatch:function(i,e){var n=this.spirit.element,r=null;return t.CustomEvent&&!gui.Client.isExplorer?r=new CustomEvent(i,e):(e=e||{bubbles:!1,cancelable:!1,detail:void 0},r=document.createEvent("HTMLEvents"),r.initEvent(i,e.bubbles,e.cancelable)),r.eventName=i,n.dispatchEvent?n.dispatchEvent(r):n[i]?n[i]():n["on"+i]?n["on"+i]():void 0},handleEvent:function(t){var i=t.relatedTarget,e=this.spirit.element,r=i&&i!==e&&!n.contains(e,i);switch(t.type){case"mouseover":r&&this._mouseenter&&this.spirit.onevent(this._getfakeevent(t,"mouseenter"));break;case"mouseout":r&&this._mouseleave&&this.spirit.onevent(this._getfakeevent(t,"mouseleave"))}},_mouseenter:!1,_mouseleave:!1,_shiftEventListener:function(t,i,e,n,r){var u=t?"addEventListener":"removeEventListener";i[u](e,n,r)},_enterleavetype:function(t,i,e){var n=this.spirit;if(e!==n)throw new TypeError(i+" not (yet) supported on "+e);switch(i){case"mouseenter":return this._mouseenter=t,"mouseover";case"mouseleave":return this._mouseleave=t,"mouseout"}},_getelementtarget:function(t){return t=t?t:this.spirit.element,t instanceof gui.Spirit?t.element:t},_getfakeevent:function(t,i){var e,n=Object.create(null);for(e in t)n[e]=t[e],n.type=i;return n},_cleanup:function(t,i){var e=i[0],n=i[1],r=i[2];this.remove(t,e,n,r)},_breakdown:function(t){return e.make(t).map(function(t){return"transitionend"===t?this._transitionend():t},this)},_transitionend:function(){var t,i=document.createElement("div"),e={transition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in e)if(void 0!==i.style[t])return e[t]}})}(gui.Combo.chained,gui.Array,gui.DOMPlugin,gui.Interface,gui.Type),gui.IEventHandler={toString:function(){return"[object IEventHandler]"},handleEvent:function(t){},onevent:function(t){}},gui.SpritePlugin=gui.Plugin.extend({x:{getter:function(){return this._pos.x},setter:function(t){this._pos.x=t,this._apply()}},y:{getter:function(){return this._pos.y},setter:function(t){this._pos.y=t,this._apply()}},z:{getter:function(){return this._pos.z},setter:function(t){this._pos.z=t,this._apply()}},onconstruct:function(){gui.Plugin.prototype.onconstruct.call(this),this._pos=new gui.Position},reset:function(){this.spirit.css.set("-beta-transform","")},_pos:null,_apply:function(){var t=this._pos,i=[t.x,t.y,t.z].map(Math.round);this.spirit.css.set("-beta-transform","translate3d("+i.join("px,")+"px)")}}),gui.Spirit=gui.Class.create(Object.prototype,{element:null,document:document,window:t,toString:function(){return"[object gui.Spirit]"},exorcise:function(){this.life.destructed||(gui.Spirit.$destruct(this),gui.Spirit.$dispose(this))},onconstruct:function(){},onconfigure:function(){},onenter:function(){},onattach:function(){},onready:function(){},oninit:function(){},ondetach:function(){},onexit:function(){},ondestruct:function(){},onasync:function(){},oncrawler:function(t){},$instanceid:null,$contextid:null,$destructed:!1,$onconstruct:function(i){this.$contextid=gui.$contextid,this.element=i,this.document=document,this.window=t,gui.Spirit.$construct(this)},$ondestruct:function(){},$pluginplugins:function(){var t,i=this.constructor.$plugins;this.life=new gui.LifePlugin(this),this.config=new gui.ConfigPlugin(this),Object.keys(i).filter(function(t){return"life"!==t&&"config"!==t}).sort().forEach(function(e){t=i[e],(this.life.plugins[e]=!t.lazy)?gui.Plugin.$assign(this,e,new t(this)):gui.Plugin.$prepare(this,e,t)},this)},$debug:function(t){if(gui.debug){var i,e=this.element,n=gui.attributes[0];t?gui.attributes.every(function(t){return!e.hasAttribute(t)})&&(i="["+this.constructor.$classname+"]",e.setAttribute(n,i)):(i=e.getAttribute(n),i&&i.startsWith("[")&&e.removeAttribute(n))}}},{portals:!0,summon:function(t){return this.possess((t||document).createElement("div"))},possess:function(t){return gui.Guide.$possess(t,this)},extend:function(){var t=gui.Class.extend.apply(this,arguments);return t.$plugins=gui.Object.copy(this.$plugins),t},plugin:function(t,i,e){var n=this.$plugins,r=this.prototype;return!r.hasOwnProperty(t)||null===r.prefix||e?(!n[t]||e)&&(n[t]=i,r.prefix=null,gui.Class.children(this,function(n){n.plugin(t,i,e)})):console.error("Plugin naming crash in "+this+": "+t),this},$plugins:Object.create(null)},{$construct:function(t){t.$pluginplugins(),t.$debug(!0),t.life.constructed=!0,t.onconstruct(),t.life.dispatch(gui.LIFE_CONSTRUCT)},$configure:function(t){t.config.configureall(),t.life.configured=!0,t.onconfigure(),t.life.dispatch(gui.LIFE_CONFIGURE)},$enter:function(t){gui.Guide.$inside(t),t.life.entered=!0,t.onenter(),t.life.dispatch(gui.LIFE_ENTER)},$attach:function(t){gui.Guide.$inside(t),t.life.attached=!0,t.onattach(),t.life.dispatch(gui.LIFE_ATTACH)},$ready:function(t){t.life.ready=!0,t.onready(),t.life.dispatch(gui.LIFE_READY)},$detach:function(t){gui.Guide.$outside(t),t.life.detached=!0,t.life.visible=!1,t.life.dispatch(gui.LIFE_DETACH),t.life.dispatch(gui.LIFE_INVISIBLE),t.ondetach()},$exit:function(t){t.life.exited=!0,t.life.dispatch(gui.LIFE_EXIT),t.onexit()},$async:function(t){t.life.async=!0,t.onasync(),t.life.dispatch(gui.LIFE_ASYNC)},$destruct:function(t){t.$debug(!1),t.life.destructed=!0,t.life.dispatch(gui.LIFE_DESTRUCT),t.ondestruct()},$dispose:function(t){t.$ondestruct(),t.$destructed=!0,gui.Guide.$forget(t),gui.Garbage.$collect(t)},$oninit:function(t){t.life.initialized=!0,t.life.dispatch("life-initialized"),t.oninit()},$reflex:function(t){new gui.Crawler(gui.CRAWLER_REFLEX).descend(t,{handleSpirit:function(t){t.reflex()}})}}),gui.DocumentSpirit=gui.Spirit.extend({onready:function(){gui.Spirit.prototype.onready.call(this),(this.waiting=gui.hosted)&&this.action.addGlobal(gui.$ACTION_XFRAME_VISIBILITY),this.action.dispatchGlobal(gui.ACTION_DOC_ONSPIRITUALIZED),this.broadcast.addGlobal(gui.BROADCAST_RESIZE_END)},onaction:function(t){switch(gui.Spirit.prototype.onaction.call(this,t),this.action.$handleownaction=!1,t.type){case gui.$ACTION_XFRAME_VISIBILITY:this._waiting=!1,gui.hasModule("gui-layout@wunderbyte.com")&&(t.data===!0?this.visibility.on():this.visibility.off()),t.consume()}},onbroadcast:function(t){gui.Spirit.prototype.onbroadcast.call(this,t),t.type===gui.BROADCAST_RESIZE_END},oncrawler:function(t){var i=gui.Spirit.prototype.oncrawler.call(this,t);if(i===gui.Crawler.CONTINUE)switch(t.type){case gui.CRAWLER_VISIBLE:case gui.CRAWLER_INVISIBLE:this._waiting&&(i=gui.Crawler.STOP)}return i},onvisible:function(){this.css.remove(gui.CLASS_INVISIBLE),gui.Spirit.prototype.onvisible.call(this)},oninvisible:function(){this.css.add(gui.CLASS_INVISIBLE),gui.Spirit.prototype.oninvisible.call(this)},_loaded:!1,_waiting:!1,_timeout:null}),gui.IframeSpirit=gui.Spirit.extend({spiritualized:!1,fit:!1,xguest:null,contentWindow:{getter:function(){return this.element.contentWindow}},contentDocument:{getter:function(){return this.element.contentDocument}},contentLocation:null,onconstruct:function(){gui.Spirit.prototype.onconstruct.call(this),this.event.add("message",t),this._postbox=[]},onenter:function(){gui.Spirit.prototype.onenter.call(this),this.event.add("load"),this.action.addGlobal([gui.ACTION_DOC_ONDOMCONTENT,gui.ACTION_DOC_ONLOAD,gui.ACTION_DOC_ONHASH,gui.ACTION_DOC_ONSPIRITUALIZED,gui.ACTION_DOC_UNLOAD]),this.fit&&(this.css.height=0);var t=this.element.src;t&&t!==gui.IframeSpirit.SRC_DEFAULT&&(t.startsWith("blob:")||this._setupsrc(t))},onaction:function(t){gui.Spirit.prototype.onaction.call(this,t),this.action.$handleownaction=!1;var i;switch(t.type){case gui.ACTION_DOC_ONDOMCONTENT:this.contentLocation=new gui.URL(document,t.data),this.life.dispatch(gui.LIFE_IFRAME_DOMCONTENT),this.action.remove(t.type),t.consume();break;case gui.ACTION_DOC_ONLOAD:this.contentLocation=new gui.URL(document,t.data),this.life.dispatch(gui.LIFE_IFRAME_ONLOAD),this.action.remove(t.type),t.consume();break;case gui.ACTION_DOC_ONHASH:i=this.contentLocation.href.split("#")[0],this.contentLocation=new gui.URL(document,i+t.data),this.life.dispatch(gui.LIFE_IFRAME_ONHASH),t.consume();break;case gui.ACTION_DOC_ONSPIRITUALIZED:this._onspiritualized(),this.life.dispatch(gui.LIFE_IFRAME_SPIRITUALIZED),this.action.remove(t.type),t.consume();break;case gui.ACTION_DOC_UNLOAD:this._onunload(),this.life.dispatch(gui.LIFE_IFRAME_UNLOAD),this.action.add([gui.ACTION_DOC_ONCONSTRUCT,gui.ACTION_DOC_ONDOMCONTENT,gui.ACTION_DOC_ONLOAD,gui.ACTION_DOC_ONSPIRITUALIZED]),t.consume()}},onevent:function(t){switch(gui.Spirit.prototype.onevent.call(this,t),t.type){case"message":this._onmessage(t.data,t.origin,t.source);break;case"load":}},onvisible:function(){gui.Spirit.prototype.onvisible.call(this),this.spiritualized&&this._visibility()},oninvisible:function(){gui.Spirit.prototype.oninvisible.call(this),this.spiritualized&&this._visibility()},src:function(t){return t&&(this._setupsrc(t),this.element.src=t),this.element.src},url:function(t,i){return i&&this._setupsrc(i),t&&(this.element.src=t),this.contentLocation.href},postMessage:function(t){this.spiritualized?this.contentWindow.postMessage(t,"*"):this._postbox.push(t)},_setupsrc:function(t){var i=document;this.contentLocation=new gui.URL(i,t),this.xguest=function(e){if(e)return"*";if(gui.URL.external(t,i)){var n=new gui.URL(i,t);return n.protocol+"//"+n.host}return null}(this._sandboxed())},_onspiritualized:function(){for(this.spiritualized=!0;this._postbox.length;)this.postMessage(this._postbox.shift());this._visibility()},_onfit:function(t){this.fit&&(this.css.height=t,this.action.dispatchGlobal(gui.ACTION_DOC_FIT))},_onunload:function(){this.spiritualized=!1,this.fit&&(this.css.height=0)},_onmessage:function(t,i,e){if(e===this.contentWindow&&t.startsWith("spiritual-action:")){var n=gui.Action.parse(t);n.direction===gui.Action.ASCEND&&(this.action.$handleownaction=!0,this.action.ascendGlobal(n.type,n.data))}},_sandboxed:function(){var t=this.element.sandbox;return t&&t.length},_visibility:function(){gui.hasModule("gui-layout@wunderbyte.com")&&gui.Type.isDefined(this.life.visible)&&this.action.descendGlobal(gui.$ACTION_XFRAME_VISIBILITY,this.life.visible)}},{summon:function(t,i){var e=t.createElement("iframe"),n=this.possess(e);if(n.css.add("gui-iframe"),i){if(gui.URL.external(i,t)){var r=new gui.URL(t,i);n.xguest=r.protocol+"//"+r.host}}else i=this.SRC_DEFAULT;return e.src=i,n}},{SRC_DEFAULT:"javascript:void(false);"}),gui.Position=function(t,i,e){this.x=t||0,this.y=i||0,this.z=e||0},gui.Position.prototype={x:0,y:0,z:0,toString:function(){return"[object gui.Position]"},clone:function(){return new gui.Position(this.x,this.y,this.z)}},gui.Position.isEqual=function(t,i){return t.x===i.x&&t.y===i.y},gui.Dimension=function(t,i){this.w=t||0,this.h=i||0},gui.Dimension.prototype={w:0,h:0,toString:function(){return"[object gui.Dimension]"}},gui.Dimension.isEqual=function(t,i){return t.w===i.w&&t.h===i.h},gui.Geometry=function(t,i,e,n){this.x=t||0,this.y=i||0,this.w=e||0,this.h=n||0},gui.Geometry.prototype={x:0,y:0,w:0,h:0,toString:function(){return"[object gui.Geometry]"},hitTest:function(t){return gui.Geometry.hitTest(this,t)}},gui.Geometry.isEqual=function(t,i){return t.x===i.x&&t.y===i.y&&t.w===i.w&&t.h===i.h},gui.Geometry.hitTest=function(t,i){function e(t,i){return t.x>=i.x&&t.x<=i.x+i.w}function n(t,i){return t.y>=i.y&&t.y<=i.y+i.h}var r=e(t,i)||e(i,t),u=n(t,i)||n(i,t);return r&&u},gui.DOMChanger={init:function(){var t=Element.prototype;if(gui.Type.isDefined(t.spirit))throw new Error("Spiritual loaded twice?");t.spirit=null},change:function(){var t=gui.Client.isExplorer?HTMLElement:Element;this._change(t.prototype,gui.DOMCombos)},_change:function(t,i){var e=document.documentElement;gui.Object.each(i,function(i,n){this._docombo(t,i,n,e)},this)},_docombo:function(t,i,e,n){this._ismethod(i)?this._domethod(t,i,e):gui.Client.isGecko?this._dogeckoaccessor(t,i,e,n):gui.Client.isExplorer&&this._doieaccessor(t,i,e)},_ismethod:function(t){var i=!1;switch(t){case"appendChild":case"removeChild":case"insertBefore":case"replaceChild":case"setAttribute":case"removeAttribute":case"insertAdjecantHTML":i=!0}return i},_domethod:function(t,i,e){var n=t[i];t[i]=e(function(){return n.apply(this,arguments)})},_doieaccessor:function(t,i,e){var n=Object.getOwnPropertyDescriptor(t,i);n&&Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:function(){return n.get.call(this)},set:e(function(t){n.set.call(this,t)})})},_dogeckoaccessor:function(t,i,e,n){var r=n.__lookupGetter__(i),u=n.__lookupSetter__(i);r&&(t.__defineGetter__(i,function(){return r.apply(this,arguments)}),t.__defineSetter__(i,e(function(){u.apply(this,arguments)})))}},gui.DOMCombos=function(t,i,e,n,r,u,o,s){var a=n(function(){return u.embedded(this)}),c=n(function(){var t=gui.get(this);return t&&!t.$destructed}),l=e(function(t,i){var e;if(r.isDocumentFragment(i)&&(e=s.from(i.childNodes)),t(),r.isDocumentFragment(i))for(var n=0,u=e.length;u>n;n++)gui.spiritualize(e[n]);else gui.spiritualize(i)}),h=t(function(t,i){gui.materialize(i)}),g=t(function(t){gui.Guide.$detach(t)}),f=t(function(t,i){this.spirit.att.set(t,i)}),d=t(function(t){this.spirit.att.del(t)}),p=e(function(t){return gui.DOMObserver.observes?gui.DOMObserver.suspend(function(){return t()}):t()}),m=t(function(){gui.materializeSub(this)}),_=i(function(){gui.spiritualizeSub(this)}),y=null,b=t(function(){y=this.parentNode,gui.materialize(this)}),v=i(function(){gui.spiritualize(y)}),O=i(function(t,i){switch(t){case"beforebegin":console.warn("TODO: Spiritualize previous siblings");break;case"afterbegin":console.warn("TODO: Spiritualize first children");break;case"beforeend":console.warn("TODO: Spiritualize last children");break;case"afterend":console.warn("TODO: Spiritualize following children")}}),E=n(function(){var t=this.ownerDocument.defaultView;return t?t.gui.mode!==gui.MODE_HUMAN:!1}),T=n(function(){var t=this.ownerDocument.defaultView;return t?t.gui.mode!==gui.MODE_FUNNY:!1}),A=function(t){return t};return{appendChild:function(t){return E(T(a(l(p(t)),A(t)),A(t)),A(t))},insertBefore:function(t){return E(T(a(l(p(t)),A(t)),A(t)),A(t))},replaceChild:function(t){return E(a(h(T(l(p(t)),A(p(t)))),A(t)),A(t))},insertAdjecantHTML:function(t){return E(a(T(O(p(t)),A(p(t)))),A(t)),A(t)},removeChild:function(t){return E(a(g(p(t)),A(t)),A(t))},setAttribute:function(t){return E(a(c(f(t),A(t)),A(t)),A(t))},removeAttribute:function(t){return E(a(c(d(t),A(t)),A(t)),A(t))},innerHTML:function(t){return E(a(m(_(p(t))),A(t)),A(t))},outerHTML:function(t){return E(a(b(v(p(t))),A(t)),A(t))},textContent:function(t){return E(a(m(p(t)),A(t)),A(t))}}}(gui.Combo.before,gui.Combo.after,gui.Combo.around,gui.Combo.provided,gui.Type,gui.DOMPlugin,gui.DOMObserver,gui.Array),gui.DOMObserver={observes:!1,observe:function(){if(!gui.Client.hasMutations)throw new Error("MutationObserver no such thing");if(!this._observer){var t=this._mutationobserver(),i=gui.DOMObserver;this._observer=new t(function(t){t.forEach(function(t){i._handleMutation(t)})})}this._connect(!0),this.observes=!0},suspend:function(t,i){var e;return this.observes&&1===++this._suspend&&this._connect(!1),gui.Type.isFunction(t)&&(e=t.call(i)),this.observes&&this.resume(),e},resume:function(){this.observes&&0===--this._suspend&&this._connect(!0)},_suspend:0,_observer:null,_mutationobserver:function(){return t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver},_connect:function(t){var i=this._observer;i&&(t?i.observe(document,{childList:!0,subtree:!0}):i.disconnect())},_handleMutation:function(t){var i=!0;Array.forEach(t.removedNodes,function(t){t.nodeType===Node.ELEMENT_NODE&&gui.materialize(t,i)},this),Array.forEach(t.addedNodes,function(t){t.nodeType===Node.ELEMENT_NODE&&gui.spiritualize(t)},this)}},gui.Assistant=function(t){return{$possess:function(t,i){if(t.spirit)throw new Error("Cannot repossess element with spirit "+t.spirit+" (exorcise first)");if(gui.debug&&!gui.Type.isSpiritConstructor(i))throw new Error("Not a spirit constructor ("+gui.Type.of(i)+")");return t.spirit=new i(t),t.spirit},$maybepossess:function(t,i){var e;return t.spirit||(e=this._maybepossess(t,i))&&this.$possess(t,e),t.spirit},$detectspirits:function(i,e,n,r){var u,o=[],s=this;return new t(gui.CRAWLER_SPIRITUALIZE).descend(i,{handleElement:function(a){if(e&&a===i||(u=a.spirit,u||(u=s.$maybepossess(a,r)),u&&(u.life.attached||o.push(u))),n)return t.SKIP_CHILDREN;if(!a.childElementCount)return t.SKIP_CHILDREN;if(a.hasAttribute("tempname"))return t.SKIP_CHILDREN;switch(a.localName){case"pre":case"code":return t.SKIP_CHILDREN}return t.CONTINUE}}),o},_maybepossess:function(t,i){var e=null;return t.nodeType===Node.ELEMENT_NODE&&gui.attributes.every(function(i){return e=this._maybepossessinline(t,i),null===e},this)&&i&&i.every(function(i){var n=i[0],r=i[1];return gui.CSSPlugin.matches(t,n)&&(e=r),null===e},this),e},_maybepossessinline:function(t,i){var e=null,n=t.getAttribute(i);return gui.Type.isString(n)&&!n.startsWith("[")&&(""!==n?(e=gui.Object.lookup(n),
e||console.error(n+" is not defined.")):e=!1),e}}}(gui.Crawler),gui.Guide=function(t,i,e,n,r,u,o,s){var a={incoming:[],inside:Object.create(null),outside:Object.create(null)};return{toString:function(){return"[object gui.Guide]"},suspend:function(t,i){this._suspended=!0;var e=t.call(i);return this._suspended=!1,e},$startGuiding:function(){this._startGuiding(),n.dispatch(gui.BROADCAST_WILL_SPIRITUALIZE),this._spiritualizeinitially(),n.dispatch(gui.BROADCAST_DID_SPIRITUALIZE)},$possess:function(i,e){return t.$possess(i,e)},$spiritualize:function(t){t=i.isSpirit(t)?t.element:t,this._maybespiritualize(t,!1,!1)},$spiritualizeSub:function(t){this._maybespiritualize(t,!0,!1)},$spiritualizeOne:function(t){this._maybespiritualize(t,!1,!0)},$materialize:function(t,i){this._maybematerialize(t,!1,!1,i)},$materializeSub:function(t){this._maybematerialize(t,!0,!1)},$materializeOne:function(t){this._maybematerialize(t,!1,!0)},$detach:function(t){this._maybedetach(t)},$forget:function(t){var i=a,e=t.$instanceid;delete i.inside[e],delete i.outside[e],this._stoptracking(t)},$channel:function(){switch(i.of(arguments[0])){case"string":this._channelOne.apply(this,arguments);break;case"array":this._channelAll.apply(this,arguments)}},$hasChannels:function(){return this._channels&&this._channels.length},$getChannels:function(){return this._channels.slice()},$debug:function(){console.log(this._channels.reduce(function(t,i){return t+"\n\n"+i[0]+" : "+i[1]},location.href))},$inside:function(t){var i=a,e=t.$instanceid;i.inside[e]||(i.outside[e]&&delete i.outside[e],i.inside[e]=t,i.incoming.push(t),o.dispatch(gui.$TICK_INSIDE,4))},$outside:function(t){var i=a,e=t.$instanceid;i.outside[e]||(i.inside[e]&&(delete i.inside[e],this._stoptracking(t)),i.outside[e]=t,o.dispatch(gui.$TICK_OUTSIDE,0))},$goasync:function(t){if(t.forEach(function(t){u.$async(t)}),gui.hosted){var i=gui.get("html");if(void 0===i.life.visible)return}this._visibility(t)},$getSpiritById:function(t){return a.inside[t]||null},_arrivals:Object.create(null),_channels:[],_todochannels:null,_suspended:!1,_startGuiding:function(){var t=[gui.$TICK_INSIDE,gui.$TICK_OUTSIDE];gui.Tick.add(t,{ontick:function(i){i.type===t[0]?gui.Guide._updateincoming():gui.Guide._updateoutside()}}),this._todochannels&&(this._channelAll(this._todochannels),this._todochannels=null)},_spiritualizeinitially:function(){var t=document.documentElement;gui.DOMChanger.init(),this.$spiritualizeOne(t),gui.mode===gui.MODE_ROBOT&&(gui.DOMChanger.change(),gui.Client.isWebKit&&gui.DOMObserver.observe(),this.$spiritualizeSub(t))},_handles:function(t,e){return t&&!this._suspended&&(e||r.embedded(t))&&i.isElement(t)},_collect:function(t,i,e){var n=[];return new s(e).descend(t,{handleSpirit:function(e){i&&e.element===t||e.life.destructed||n.push(e)}}),n},_maybespiritualize:function(t,e,n){t=i.isSpirit(t)?t.element:t,t=i.isDocument(t)?t.documentElement:t,this._handles(t)&&this._spiritualize(t,e,n)},_spiritualize:function(i,e,n){var r,u=this._channels;e=!1,r=t.$detectspirits(i,e,n,u),this._sequence(r)},_sequence:function(){function t(t){return t.life.configured||u.$configure(t),t}function i(t){return t.life.entered||u.$enter(t),t}function e(t){return u.$attach(t),t}function n(t){t.life.ready||u.$ready(t)}return function(r){r.map(t).map(i).map(e).reverse().forEach(n)}}(),_maybematerialize:function(t,e,n,r,u){t=i.isSpirit(t)?t.element:t,t=i.isDocument(t)?t.documentElement:t,(r||this._handles(t,u))&&(t.setAttribute("gui-matarializing","true"),this._materialize(t,e,n),t.removeAttribute("gui-matarializing"))},_materialize:function(t,i,e){this._collect(t,i,gui.CRAWLER_MATERIALIZE).reverse().filter(function(t){return t.life.attached&&!t.life.destructed?(u.$destruct(t),!0):!1}).forEach(function(t){u.$dispose(t)})},_maybedetach:function(t){t=i.isSpirit(t)?t.element:t,this._handles(t)&&this._collect(t,!1,gui.CRAWLER_DETACH).forEach(function(t){u.$detach(t)})},_channelOne:function(t,e){var n;gui.initialized?(n="string"==typeof e?gui.Object.lookup(e):e,!gui.debug||i.isSpiritConstructor(n)?this._channels.unshift([t,n]):console.error('Bad spirit for selector "'+t+'": '+n)):(this._todochannels=this._todochannels||[],this._todochannels.push([t,e]))},_channelAll:function(t){gui.initialized?t.forEach(function(t){this._channelOne(t[0],t[1])},this):(this._todochannels=this._todochannels||[],this._todochannels=this._todochannels.concat(t.reverse()))},_stoptracking:function(t){var i=a.incoming;if(i.length){var n=i.indexOf(t);n>-1&&e.remove(i,n)}},_updateincoming:function(){gui.Guide.$goasync(a.incoming),a.incoming=[]},_updateoutside:function(){var t=a.outside,i=gui.Object.each(t,function(t,i){return i});i.forEach(function(t){u.$destruct(t)}),i.forEach(function(t){u.$dispose(t)}),a.outside=Object.create(null)},_visibility:function(t){gui.hasModule("gui-layout@wunderbyte.com")&&r.group(t).forEach(function(t){gui.VisibilityPlugin.$init(t)},this)}}}(gui.Assistant,gui.Type,gui.Array,gui.Broadcast,gui.DOMPlugin,gui.Spirit,gui.Tick,gui.Crawler),gui.Module.mixin({onbeforespiritualize:function(){},onafterspiritualize:function(){},$onconstruct:function(t){this.$modname=t,gui.Module.$init(this),this.toString=function(){return"[module "+t+"]"}}},{},{$init:function(t){gui.Type.isObject(t.mixin)&&gui.Spirit.mixin(t.mixin),gui.Type.isArray(t.channel)&&gui.channel(t.channel),gui.Type.isObject(t.plugin)&&gui.Object.each(t.plugin,function(t,i){gui.Type.isDefined(i)?gui.Spirit.plugin(t,i):console.error("Undefined plugin for prefix: "+t)})}}),function(t){t.forEach(gui.Module.$init)}(gui.Module._modules),function(t){gui.Object.each({onbeforespiritualize:gui.BROADCAST_WILL_SPIRITUALIZE,onafterspiritualize:gui.BROADCAST_DID_SPIRITUALIZE},function(i,e){gui.Broadcast.add(e,{onbroadcast:function(){t.forEach(function(t){t[i]()})}})})}(gui.Module._modules),gui.module("gui-spirits@wunderbyte.com",{channel:[["html",gui.DocumentSpirit],[".gui-iframe",gui.IframeSpirit],[".gui-spirit",gui.Spirit]],plugin:{"super":gui.SuperPlugin,action:gui.ActionPlugin,broadcast:gui.BroadcastPlugin,tick:gui.TickPlugin,att:gui.AttPlugin,config:gui.ConfigPlugin,box:gui.BoxPlugin,css:gui.CSSPlugin,dom:gui.DOMPlugin,event:gui.EventPlugin,life:gui.LifePlugin,sprite:gui.SpritePlugin},mixin:{onaction:function(t){},onbroadcast:function(t){},ontick:function(t){},onatt:function(t){},onevent:function(t){},onlife:function(t){},handleEvent:function(t){"webkitTransitionEnd"===t.type&&(t={type:"transitionend",target:t.target,propertyName:t.propertyName,elapsedTime:t.elapsedTime,pseudoElement:t.pseudoElement}),this.onevent(t)},$ondestruct:gui.Combo.before(function(){this.handleEvent=function(){}})(gui.Spirit.prototype.$ondestruct)}})}(self);
//# sourceMappingURL=spiritual-gui.js.map