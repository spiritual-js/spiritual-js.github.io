!function(e){"use strict";e.edb=gui.namespace("edb",function(e){return{version:"-1.0.0",debug:!1,$accessaware:!1,BROADCAST_ACCESS:"edb-broadcast-access",BROADCAST_CHANGE:"edb-broadcast-change",BROADCAST_OUTPUT:"edb-broadcast-output",BROADCAST_SCRIPT_INVOKE:"edb-broadcast-script-invoke",TICK_SCRIPT_UPDATE:"edb-tick-script-update",TICK_COLLECT_INPUT:"edb-tick-collect-input",TICK_PUBLISH_CHANGES:"edb-tick-update-changes",get:function(){console.error("Deprecated API is deprecated: edb.get()")}}}(gui.Arguments.confirmed)),edb.Type=function(e){return gui.Class.create(null,{onconstruct:function(){},ondestruct:function(){},output:e(function(){edb.Output.$output(this)}),outputGlobal:e(function(){console.error("Not supported just yet: "+this+".outputGlobal()")}),revoke:e(function(){edb.Output.$revoke(this)}),dispose:e(function(){edb.Type.$destruct(this)}),serializeToString:function(e,t){return(new edb.Serializer).serializeToString(this,e,t)},$originalid:null,$destructed:!1,$onconstruct:function(){},$ondestruct:function(){this.constructor.storage&&this.persist()}})}(gui.Combo.chained),edb.Type.mixin(null,null,{is:function(e){return edb.Object.is(e)||edb.Array.is(e)},isConstructor:function(e){return gui.Type.isGuiClass(e)&&gui.Class.ancestorsAndSelf(e).some(function(e){return e===edb.Object||e===edb.Array})},lookup:function(e,t){var n=null;switch(gui.Type.of(t)){case"function":n=t;break;case"string":n=gui.Object.lookup(t,e);break;case"object":console.error(this+": expected edb.Type constructor (not an object)")}if(!n)throw new TypeError('The type "'+t+'" does not exist');return n},cast:function(e){if(gui.Type.isComplex(e)&&!edb.Type.is(e))switch(gui.Type.of(e)){case"object":return edb.Object.from(e);case"array":return edb.Array.from(e)}return e},mixin:function(e,t,n){return[edb.Object,edb.Array].forEach(function(i){i.mixin(e,t,n)}),this},$observe:function(e,t){var n=e.$instanceid,i=this._observers,r=i[n]||(i[n]=[]);return-1===r.indexOf(t)&&r.push(t),e},$unobserve:function(e,t){var n,i=e.$instanceid,r=this._observers,o=r[i];return o&&(n=o.indexOf(t))>-1&&0===gui.Array.remove(o,n)&&delete r[i],e},$destruct:function(e){(new edb.Crawler).crawl(e,{ontype:function(t){t.$destructed||(e.ondestruct(),e.$ondestruct(),e.$destructed=!0,gui.unloading||gui.Garbage.$nukeallofit(e))}})}}),function(e){var t={isOutput:function(){return edb.Output.$is(this)},getOutput:function(){console.error("Deprecated API is deprecated: getOutput()")},revokeOutput:function(){console.error("Deprecated API is deprecated: revokeOutput()")}},n={from:gui.Arguments.confirmed("(string|object|array|null)")(function(e){var t=this;return e&&(edb.Type.is(e)&&(e=(new edb.Serializer).serializeToString(e)),gui.Type.isString(e)&&(e.includes("$object")||e.includes("$array"))&&(e=(new edb.Parser).parseFromString(e,null))),new t(e)}),extend:function(){var e=gui.Class.extend.apply(this,arguments);return e.output=new edb.Output(e),e}};[t,n].forEach(function(e){gui.Object.each(e,function(e,t){edb.Type[e]=t})}),edb.Type.$staticmixins=function(){var e={};return[t,n].forEach(function(t){Object.keys(t).forEach(function(n){e[n]=t[n]},this)},this),e}}(gui.Arguments.confirmed),edb.Object=function(e,t){return gui.Class.create(Object.prototype,{addObserver:e("object|function")(t(function(e){edb.Object.observe(this,e)})),removeObserver:e("object|function")(t(function(e){edb.Object.unobserve(this,e)})),$onconstruct:function(e){switch(edb.Type.prototype.$onconstruct.apply(this,arguments),gui.Type.of(e)){case"object":case"undefined":case"null":var t=gui.Object.copy(e||{}),n=edb.ObjectPopulator.populate(t,this);edb.ObjectProxy.approximate(t,this,n);break;default:throw new TypeError("Unexpected edb.Object constructor argument of type "+gui.Type.of(e)+": "+String(e))}this.onconstruct(),this.oninit&&console.error("Deprecated API is deprecated: "+this+".oninit")},toJSON:function(){return gui.Object.map(this,function(e,t){var n=e.charAt(0);return"$"!==n&&"_"!==n?edb.Type.is(t)?t.toJSON():t:void 0})}})}(gui.Arguments.confirmed,gui.Combo.chained),edb.Object.mixin(null,edb.Type.$staticmixins(),{observe:edb.Type.$observe,unobserve:edb.Type.$unobserve,ontick:function(e){var t,n,i,r=this._observers;e.type===edb.TICK_PUBLISH_CHANGES&&(t=gui.Object.copy(this._changes),this._changes=Object.create(null),gui.Object.each(t,function(e,o){(i=r[e])&&(n=[],gui.Object.each(t,function(t,i){t===e&&gui.Object.each(i,function(e,t){n.push(t)})}),i.forEach(function(e){e.onchange(n)}))}))},$onaccess:function(e,t){edb.$accessaware&&gui.Broadcast.dispatch(edb.BROADCAST_ACCESS,[e,t])},$onchange:function(e,t,n,i){if(n!==i){var r=edb.ObjectChange.TYPE_UPDATE,o=this._changes,s=e.$instanceid,u=o[s]=o[s]||(o[s]=Object.create(null));u[t]=new edb.ObjectChange(e,t,r,n,i),gui.Tick.dispatch(edb.TICK_PUBLISH_CHANGES)}},_observers:Object.create(null),_changes:Object.create(null)}),function(){gui.Tick.add(edb.TICK_PUBLISH_CHANGES,edb.Object),gui.Object.extendmissing(edb.Object.prototype,edb.Type.prototype)}(),function(e,t){function n(e,t){return edb.ArrayPopulator.convert(e,t)}function i(e,t,n,i){edb.Array.$onchange(e,t,n,i)}function r(e){var t=e.$instanceid;return edb.Array._observers[t]?!0:!1}edb.Array=gui.Class.create(e,{push:function(){var t=this.length,o=n(this,arguments),s=e.push.apply(this,o);return r(this)&&i(this,t,null,o),s},pop:function(){var t=this.length-1,n=e.pop.apply(this);return r(this)&&t>=0&&i(this,t,[n],null),n},shift:function(){var t=e.shift.apply(this);return r(this)&&i(this,0,[t],null),t},unshift:function(){var t=n(this,arguments),o=e.unshift.apply(this,t);return r(this)&&i(this,0,null,t),o},splice:function(){var t=arguments,o=t[0],s=n(this,[].slice.call(t,2)),u=[o,t[1]].concat(s),c=e.splice.apply(this,u);return r(this)&&i(this,o,c,s),c},reverse:function(){if(r(this)){var t=this.toJSON(),n=e.reverse.apply(t.slice());i(this,0,t,n)}return e.reverse.apply(this)},onconstruct:function(e){},addObserver:t(function(e){edb.Object.observe(this,e),edb.Array.observe(this,e)}),removeObserver:t(function(e){edb.Object.unobserve(this,e),edb.Array.unobserve(this,e)}),$of:null,$onconstruct:function(){var e,t;edb.Type.prototype.$onconstruct.apply(this,arguments),arguments.length&&(e=arguments[0]?arguments[0].$object||{}:{},t=edb.ObjectPopulator.populate(e,this),edb.ArrayPopulator.populate(this,arguments),edb.ObjectProxy.approximate(e,this,t)),this.onconstruct([].slice.call(this))},get:function(e){return edb.$accessaware&&edb.Array.$onaccess(this,e),this[e]},getLength:function(e){return edb.$accessaware&&edb.Array.$onaccess(this,e),this.length},setLength:function(e){for(var t=[];this.length>e;)t.push(this.pop());t.length&&i(this,this.length-1,t)},toJSON:function(){return Array.map(this,function(e){return edb.Type.is(e)?e.toJSON():e})}})}(Array.prototype,gui.Combo.chained),edb.Array.mixin(null,edb.Type.$staticmixins(),{observe:edb.Type.$observe,unobserve:edb.Type.$unobserve,isConstructor:function(e){return gui.Type.isConstructor(e)&&gui.Class.ancestorsAndSelf(e).indexOf(edb.Array)>-1},ontick:function(e){var t,n,i=this._observers;e.type===edb.TICK_PUBLISH_CHANGES&&(t=gui.Object.copy(this._changes),this._changes=Object.create(null),gui.Object.each(t,function(e,t){(n=i[e])&&n.forEach(function(e){e.onchange(t)})}))},_observers:Object.create(null),_changes:Object.create(null),$onaccess:function(e,t){edb.$accessaware&&gui.Broadcast.dispatch(edb.BROADCAST_ACCESS,[e])},$onchange:function(e,t,n,i){var r=e.$instanceid,o=this._changes,s=o[r]||(o[r]=[]);s.push(new edb.ArrayChange(e,t,n,i)),gui.Tick.dispatch(edb.TICK_PUBLISH_CHANGES)}}),function(e){function t(e,t){t.forEach(function(t){e[t]=n(e[t])})}var n=gui.Combo.before(function(){edb.$accessaware&&edb.Array.$onaccess(this,-1)});t(e,["filter","forEach","every","map","some","indexOf","lastIndexOf","slice"])}(edb.Array.prototype),function(){gui.Tick.add(edb.TICK_PUBLISH_CHANGES,edb.Array),gui.Object.extendmissing(edb.Array.prototype,edb.Type.prototype)}(),edb.ObjectPopulator=function(e,t,n,i){function r(e){var t=edb.Object.is(e)?edb.Object:edb.Array,n=edb.Object.is(e)?Object:Array,i=[],r=[edb.Type,t,n];return gui.Object.all(e,function(e){c(e)&&r.every(function(t){return void 0===t.prototype[e]})&&i.push(e)}),i}function o(e,t){var n=e.$originalid||e.$instanceid;delete e.$instanceid,delete e.$originalid,n&&Object.defineProperty(t,"$originalid",gui.Property.nonenumerable({value:n}))}function s(e,t){throw new TypeError(e+' declares "'+t+'" as something undefined')}function u(e,t){throw new TypeError(e+' "'+t+'" must resolve to a constructor')}function c(e){return e.match(/^[a-z]/i)}function a(e,t){return e.hasOwnProperty(t)?Object.getOwnPropertyDescriptor(e,t):(e=Object.getPrototypeOf(e))?a(e,t):null}return{populate:function(d,l){var p,h,f,b,m=Object.create(null),g=l.constructor.prototype,y=l.constructor.$classname,_=[];return o(d,l),r(l).forEach(function(r){switch(h=l[r],f=d[r],h){case Object:l[r]={},_.push(r);break;case Array:f&&Array.isArray(f)?l[r]=f.slice():l[r]=[],_.push(r);break;default:e(f)?e(h)?t(h)&&(n(h)?(i(h)||(h=h(f)),i(h)?null!==f&&(p=h,m[r]=p.from(d[r])):u(y,r)):m[r]=edb.Type.cast(e(f)?f:h)):s(y,r):c(r)&&edb.Type.isConstructor(h)?(edb.Array.isConstructor(h)?d[r]=[]:d[r]=null,p=h,m[r]=p.from(d[r])):(b=a(g,r))&&Object.defineProperty(d,r,b)}}),gui.Object.nonmethods(d).filter(function(e){return-1===_.indexOf(e)}).forEach(function(e){var t=d[e];c(e)&&gui.Type.isComplex(t)&&(m[e]||(m[e]=edb.Type.cast(t)))}),m}}}(gui.Type.isDefined,gui.Type.isComplex,gui.Type.isFunction,gui.Type.isConstructor),edb.ArrayPopulator=function(){function e(e){return e.$of&&e.$of.prototype.reverse}function t(e){return Array.isArray(e)||edb.Array.is(e)}function n(e,t){if(!gui.debug||edb.Type.isConstructor(e)){if(!edb.Type.is(t))return new e(t);if(e.is(t))return t;r(e,t)}else r("edb.Type",e)}function i(e,t){var i=e(t);return gui.Type.isConstructor(i)?i=n(i,t):edb.Type.is(i)||null===i?i=i:r("edb.Type constructor or instance",gui.Type.of(i),"return null for nothing"),i}function r(e,t,n){throw new TypeError("$of expected "+e+", got "+t+(n?" ("+n+")":""))}function o(e,t){return e.map(function(e){return void 0!==e&&(e=gui.Type.isConstructor(t.$of)?n(t.$of,e):i(function(e){return t.$of(e)},e)),e})}function s(e){return e.map(function(e){if(!edb.Type.is(e))switch(gui.Type.of(e)){case"object":return new edb.Object(e);case"array":return new edb.Array(e)}return e})}return{populate:function(n,i){var r=i[0];r&&(!e(n)&&t(r)&&(i=r),Array.prototype.push.apply(n,this.convert(n,i)))},convert:function(e,t){if(t=gui.Array.from(t),gui.Type.isNull(e.$of))return s(t);if(gui.Type.isFunction(e.$of))return o(t,e);var n=gui.Type.of(e.$of);throw new Error(e+" cannot be $of "+n)}}}(),edb.ObjectProxy=function(){function e(e,t){return function(){var i=t.apply(this);return edb.$accessaware&&!n&&edb.Object.$onaccess(this,e),i}}function t(e,t){return function(i){n=!0;var r=this[e];t.apply(this,arguments),(i=this[e])!==r&&edb.Object.$onchange(this,e,r,i),n=!1}}var n=!1;return{approximate:function(n,i,r){gui.Object.nonmethods(n).forEach(function(o){var s=Object.getOwnPropertyDescriptor(n,o);s.configurable&&Object.defineProperty(i,o,{enumerable:s.enumerable,configurable:s.configurable,get:e(o,function(){return s.get?s.get.call(this):r[o]||n[o]}),set:t(o,function(e){var t,u;if(s.set)s.set.call(this,e);else if(u=r[o])edb.Type.is(e)?r[o]=e:(t=u.constructor,r[o]=t.from(e));else{var c=n[o];t=i.constructor;var a=t.prototype[o];switch(a){case Object:case Array:if(!gui.Type.isNull(e)&&!gui.Type.isComplex(e))throw new TypeError("Expected "+a);n[o]=e,c!==e&&edb.Object.$onchange(i,o,c,e);break;default:n[o]=edb.Type.cast(e)}}})})}),gui.Object.ownmethods(n).forEach(function(e){i[e]=n[e]})}}}(),edb.Change=function(){},edb.Change.prototype={object:null,type:null},edb.ObjectChange=function(e,t,n,i,r){this.object=e,this.name=t,this.type=n,this.oldValue=i,this.newValue=r},edb.ObjectChange.prototype=gui.Object.create(edb.Change.prototype,{name:null,oldValue:void 0,newValue:void 0}),edb.ObjectChange.TYPE_UPDATE="update",edb.ArrayChange=function(e,t,n,i){this.type=edb.ArrayChange.TYPE_SPLICE,this.object=e,this.index=t,this.removed=n||[],this.added=i||[]},edb.ArrayChange.prototype=gui.Object.create(edb.Change.prototype,{index:-1,removed:null,added:null}),edb.ArrayChange.TYPE_SPLICE="splice",edb.ArrayChange.toSpliceParams=function(e){if(e.type===edb.ArrayChange.TYPE_SPLICE){var t=e.index,n=e.removed.length,i=e.added;return[t,n].concat(i)}throw new TypeError},edb.Output=function(e){return gui.Class.create({get:function(){var e=edb.Output.$get(this._type);return e?e.data:null},revoke:e(function(){edb.Output.$revoke(this._type)}),connect:e(function(e){edb.Input.$connect(this._type,e)}),disconnect:e(function(e){edb.Input.$disconnect(this._type,e)}),_type:null,$onconstruct:function(e){this._type=e},add:function(){return this.connect.apply(this,arguments)},remove:function(){return this.disconnect.apply(this,arguments)}},{},{$output:e(function(e){var t=this._makeinput(e.constructor,e);gui.Broadcast.dispatch(edb.BROADCAST_OUTPUT,t)}),$revoke:e(function(e){var t=edb.Type.is(e)?e.constructor:e,n=this._makeinput(t,null);gui.Broadcast.dispatch(edb.BROADCAST_OUTPUT,n),delete this._map[t.$classid]}),$is:function(e){if(e){if(this._map){var t=e.$classid,n=this._map[t];return n?!0:!1}return!1}throw new TypeError("No such Type")},$get:function(e){if(e){if(this._map){var t=e.$classid,n=this._map[t];return n?new edb.Input(n.constructor,n):null}return null}throw new TypeError("No such Type")},_map:{},_makeinput:function(e,t){var n=e.$classid;return this._map[n]=t,new edb.Input(e,t)}})}(gui.Combo.chained),edb.Input=function(e,t,n,i,r){var o=new gui.MapList;return gui.Class.create({type:null,data:null,revoked:!1,onconstruct:function(e,t){if(!edb.Type.is(t)&&null!==t)throw new TypeError(t+" is not a Type instance");this.type=e,this.data=t}},{},{IInputHandler:{oninput:function(e){},toString:function(){return"[interface InputHandler]"}},$connect:e(function(e,t){e=this.$breakdown(e),n.validate(this.IInputHandler,t)&&e.every(this._check)&&this._add(e,t)}),$disconnect:e(function(e,t){return e=this.$breakdown(e),n.validate(this.IInputHandler,t)&&e.every(this._check)&&this._remove(e,t),e}),$breakdown:function(e){return i.isArray(e)?this._breakarray(e):this._breakother(e)},$onoutput:function(e){var t,n=e.data;null===n||o.each(function(i,o){t=r.get(i),n instanceof t&&o.slice().forEach(function(t){t.oninput(e)})})},$bestmatch:function(e,t,n){return this._bestmatch(e.$classid,t.map(function(e){return e.$classid}),n)},$rateall:function(e,t,n,i){t.forEach(function(t){i(t,this.$rateone(n?e:t,n?t:e))},this)},$rateone:function(e,t){return this._rateone(e.$classid,t.$classid)},_breakarray:function(e){return e.map(function(e){switch(i.of(e)){case"function":return e;case"string":return gui.Object.lookup(e);case"object":console.error("Expected function. Got object.")}},this)},_breakother:function(e){switch(i.of(e)){case"function":return[e];case"string":return this._breakarray(e.split(" "));case"object":console.error("Expected function. Got object.")}},_add:function(e,t){e.filter(function(e){return o.add(e.$classid,t)}).forEach(function(e){r.descendantsAndSelf(e,function(n){if(n.isOutput()){var i=edb.Output.$get(e);t.oninput(i)}},this)},this)},_remove:function(e,t){e.forEach(function(e){o.remove(e.$classid,t)})},_check:function(e){if(!i.isDefined(e))throw new TypeError("Could not register input for undefined Type");return!0},_bestmatch:t(function(e,t,n){var i=null,r=Number.MAX_VALUE,o=gui.Class.get(e),s=t.map(function(e){return gui.Class.get(e)});return this.$rateall(o,s,n,function(e,t){t>-1&&r>t&&(r=t,i=e)}),i}),_rateone:t(function(e,t){var n=gui.Class.get(e),i=gui.Class.get(t),r=0,o=-1,s=n;if(n===i)o=0;else for(;s=gui.Class.parent(s);)r++,s===i&&(s=null,o=r);return o}),add:function(){console.error("Deprecated API is deprecated: edb.Input.add()")},remove:function(){console.error("Deprecated API is deprecated: edb.Input.remove()")},$add:function(){return console.warn("Deprecated API is deprecated: edb.Input.$add(). Use edb.Input.$connect()"),this.$connect.apply(this,arguments)},$remove:function(){return console.warn("Deprecated API is deprecated: edb.Input.$remove(). Use edb.Input.$disconnect()"),this.$disconnect.apply(this,arguments)}})}(gui.Combo.chained,gui.Combo.memoized,gui.Interface,gui.Type,gui.Class),function(){gui.Broadcast.add(edb.BROADCAST_OUTPUT,{onbroadcast:function(e){edb.Input.$onoutput(e.data)}})}(),edb.Crawler=function(){function e(){}function t(e,r){gui.Object.each(e,n).forEach(function(e){i(e,r),t(e,r)})}function n(e,t){return edb.Type.is(t)?t:void 0}function i(e,t){t.ontype&&t.ontype(e),t.onarray&&edb.Array.is(e)&&t.onarray(e),t.onobject&&edb.Object.is(e)&&t.onobject(e)}return e.prototype={crawl:function(e,n){if(!edb.Type.is(e))throw new TypeError;i(e,n),t(e,n)}},e}(),edb.Serializer=function(){function e(){}function t(e){return edb.Type.is(e)}function n(e){return edb.Array.is(e)}function i(e){return n(e)?o(e):r(e)}function r(e){var t=gui.Object.map(e,s,e);return{$object:gui.Object.extend({$classname:e.$classname,$instanceid:e.$instanceid,$originalid:e.$originalid},t)}}function o(e){return gui.Object.extend(r(e),{$array:u(e)})}function s(e,r){var o=e.charAt(0);if("_"===o||"$"===o)return void 0;if(n(this)&&e.match(c))return void 0;if(t(r))return i(r);if(gui.Type.isComplex(r)){switch(r.constructor){case Object:case Array:return r}return void 0}if(t(this)){var s=this.constructor.prototype,u=Object.getOwnPropertyDescriptor(s,e);if(u&&(u.set||u.get))return void 0}return r}function u(e){return Array.map(e,function(e){return t(e)?i(e):e})}e.prototype={serializeToString:function(e,n,r){if(t(e))return JSON.stringify(i(e),n,r);throw new TypeError("Expected edb.Object|edb.Array")}};var c=/^length|^\d+/;return e}(),edb.Parser=function(){function e(){}function t(e,t){var n,i;if(null===t||(t?(i=t.$classname||i,n=i?t:gui.Object.lookup(i)):(i=e.$object.$classname,n=gui.Object.lookup(i))),e=s(e),null===t)return e;if(n)return n.from(e);var r=new TypeError(i+" is not defined");throw i===gui.Class.ANONYMOUS&&console.error('TODO: Spiritual should make sure that nothing is ever "'+i+'"\n'+JSON.stringify(e,null,4)),r}function n(e){return gui.Type.isComplex(e)&&(e.$array||e.$object)}function i(e){return gui.Object.map(e.$object,o)}function r(e){var t=e.$array.map(s);return t.$object=e.$object,t}function o(e,t){switch(e){case"$classname":return void 0;default:return s(t)}}function s(e){return n(e)?e.$array?r(e):i(e):e}return e.prototype={parseFromString:function(e,i){try{e=JSON.parse(e)}catch(r){throw new TypeError("Bad JSON: "+r.message)}finally{if(n(e))return t(e,i);throw new TypeError("Expected serialized edb.Object|edb.Array")}}},e}(),edb.InputPlugin=function(e,t){return gui.TrackerPlugin.extend({done:!0,onconstruct:function(){gui.TrackerPlugin.prototype.onconstruct.call(this),this._watches=[],this._matches=[],this._needing=[]},ondestruct:function(){gui.TrackerPlugin.prototype.ondestruct.call(this),this.remove(this._watches)},connect:e(function(e,n,i){var r=t.$breakdown(e);r.length&&(this.done=this.done&&i===!1,r.forEach(function(e){this._addchecks(e.$classid,[n||this.spirit]),this._watches.push(e),i&&this._needing.push(e)},this),t.$connect(r,this))}),disconnect:e(function(e,n){var i=t.$breakdown(e);i.length&&(i.forEach(function(e){this._removechecks(e.$classid,[n||this.spirit]),gui.Array.remove(this._watches,e),gui.Array.remove(this._needing,e)},this),t.$disconnect(i,this),this.done=this._done())}),one:function(){console.error("Not supported just yet: "+this+".one()")},get:function(e){var n=this._matches.map(function(e){return e.data.constructor}),i=t.$bestmatch(e,n,!1),r=i?this._matches.filter(function(e){return e.type===i}).shift():null;return r?r.data:null},oninput:function(e){this.$oninput(e)},match:function(e){var t=!this._matches.length;return t||this._matches.every(function(t){return t.$instanceid!==e.$instanceid})?this._maybeinput(e):!1},add:function(){return console.warn("Deprecated API is deprecated: input.add(). Use input.connect()"),this.connect.apply(this,arguments)},remove:function(){return console.warn("Deprecated API is deprecated: input.remove(). Use input.disconnect()"),this.disconnect.apply(this,arguments)},$oninput:function(e){if(e)return null===e.data?(this._mayberevoke(e),!1):this.match(e);throw new TypeError("Bad input: "+e+" "+(this.spirit||""))},_watches:null,_matches:null,_needing:null,_maybeinput:function(e){var n=t.$bestmatch(e.type,this._watches,!0);return n?(this._updatematch(e,n),this.done=this._done(),this._updatehandlers(e),!0):!1},_mayberevoke:function(e){var n=this._matches,i=this._watches,r=t.$bestmatch(e.type,i,!0);if(r){var o=n.filter(function(e){return e.type===r})[0],s=n.indexOf(o);n.splice(s,1),this.done=this._done(),this.done||(e.revoked=!0,this._updatehandlers(e))}},_updatematch:function(e,n){var i=this._matches,r=-1,o=-1,s=t.$rateone(e.type,n);i.forEach(function(e,i){o=t.$rateone(e.type,n),o>-1&&s>=o&&(r=i)}),r>-1?i[r]=e:i.push(e)},_updatehandlers:function(e){gui.Class.ancestorsAndSelf(e.type,function(t){var n=this._trackedtypes[t.$classid];n&&n.forEach(function(t){var n=t[0];n.oninput(e)})},this)},_done:function(){var e=this._needing,t=this._matches;return e.every(function(e){return t.some(function(t){return t.data instanceof e})})},_cleanup:function(e,n){if(this._removechecks(e,n)){var i=gui.Class.get(e);t.$remove(i,this)}}})}(gui.Combo.chained,edb.Input),gui.module("edb@wunderbyte.com",{plugin:{input:edb.InputPlugin}}),e.edbml=gui.namespace("edbml",{bootload:!1,declare:function(e){var t;return{as:function(n){return t=edbml.$runtimeconfigure(n),t=gui.Object.assert(e,t),t.lock=function(e){return function(){return n.$out=e,t.apply(this,arguments)}},this},withInstructions:function(e){t.$instructions=e}}},safetext:function(e){return edbml.Security.$safetext(e)},safeattr:function(e){return edbml.Security.$safeattr(e)},$set:function(e,t){return edbml._assign(e,t)},$get:function(e){return edbml._request(e)},$run:function(e,t){this._register(e),this._invoke(t)},$revoke:function(e){this._invokables[e]=null,delete this._invokables[e]},$runtimeconfigure:function(){function e(e,t){e.$out=e.$out||new edbml.Out,e.$att=new edbml.Att,t&&(e.$input=function(e){return t.script.$input.get(e)})}function t(e,t){e.$out=null,e.$att=null,t&&(e.$input=null)}return function(n){return function(i){e(n,this);var r=n.apply(this,arguments);return t(n,this),r}}}(),_latestevent:null,_invokables:{},_assign:function(e,t){var n=gui.KeyMaster.generateKey();return this._invokables[n]=function(n,i){return e.apply(t,[gui.Type.cast(n),i])},n},_invoke:function(e,t,n){n=n||this._latestevent,t?this._invokeremote(e,t,n):this._invokelocal(e,n)},_invokeremote:function(e,t,n){gui.Broadcast.$target=this,gui.Broadcast.dispatchGlobal(edb.BROADCAST_SCRIPT_INVOKE,{key:e,sig:t,log:n})},_invokelocal:function(e,t){var n=this._invokables[e];if(n)if(t)switch(t.type){case"click":case"tap":gui.Tick.time(function(){n(t.value,t.checked)});break;default:n(t.value,t.checked)}else n();else console.error("out of synch")},_request:function(e,t){var n;if(t)console.error("Not supported");else{if(n=this._invokables[e])return n();console.error("out of synch")}},_register:function(e){this._latestevent=e&&e.target?{type:e.type,value:e.target.value,checked:e.target.checked}:null}}),edbml.Att=function(e){e&&gui.Object.extend(this,e)},edbml.Att.prototype=gui.Object.create(null,{toString:function(){return"[object edbml.Att]"},$:function(e){var t=this[e],n="";switch(gui.Type.of(t)){case"null":case"undefined":break;default:t=edbml.Att.$encode(this[e]),n+=e+'="'+t+'" '}return n},$pop:function(e){var t=this.$(e);return delete this[e],t},$all:function(){var e="";return gui.Object.nonmethods(this).forEach(function(t){e+=this.$(t)},this),e}}),edbml.Att.$encode=function(e){var t=gui.Type.of(e);switch(t){case"string":e=edbml.safeattr(e);break;case"number":case"boolean":e=String(e);break;case"object":case"array":try{e=encodeURIComponent(JSON.stringify(e))}catch(n){throw new Error("Could not create HTML attribute: "+n)}break;case"date":throw new Error("TODO: edbml.Att.encode standard date format?");default:throw new Error("Could not create HTML attribute for "+t)}return e},edbml.Out=function(){},edbml.Out.prototype={html:"",toString:function(){return"[object edbml.Out]"},write:function(){return this.html}},edbml.Update=gui.Class.create(Object.prototype,{type:null,id:null,ids:null,window:null,document:null,onconstruct:function(){this._summary=[]},update:function(){},element:function(){var e,t=null;return gui.KeyMaster.isKey(this.id)&&(e=gui.get(this.id))&&(t=e.element),t=t||document.querySelector("#"+this.id),t||console.error("No element to match @id: "+this.id),t},dispose:function(){this._summary=null},_summary:null,_beforeUpdate:function(e){var t="x-beforeupdate-"+this.type;return this._dispatch(e,t)},_afterUpdate:function(e){var t="x-afterupdate-"+this.type;return this._dispatch(e,t)},_dispatch:function(e,t){if(e){var n=document.createEvent("UIEvents");return n.initEvent(t,!0,!0),e.dispatchEvent(n)}console.error("Occasional EDBML dysfunction just happened")},_report:function(e){edbml.debug&&(gui.KeyMaster.isKey(this.id)&&(e=e.replace(this.id,"(anonymous)")),console.debug(e,this.element()))}},{},{TYPE_HARD:"hard",TYPE_ATTS:"atts",TYPE_INSERT:"insert",TYPE_APPEND:"append",TYPE_REMOVE:"remove",TYPE_FUNCTION:"function"}),edbml.AttsUpdate=function(e){return edbml.Update.extend({type:edbml.Update.TYPE_ATTS,onconstruct:function(e,t,n){edbml.Update.prototype.onconstruct.call(this),this.id=e,this._xnew=t,this._xold=n},update:function(){edbml.Update.prototype.update.call(this);var e=this.element();e&&this._beforeUpdate(e)&&(this._update(e),this._afterUpdate(e),this._report())},dispose:function(){edbml.Update.prototype.dispose.call(this),delete this._xold,delete this._xnew},_xold:null,_xnew:null,_update:function(e){Array.forEach(this._xnew.attributes,function(t){var n=this._xold.getAttribute(t.name);(null===n||n!==t.value)&&("class"===t.name?this._classlist(e,this._xold,t.value):this._set(e,t.name,t.value),this._summary.push("@"+t.name+'="'+t.value+'"'+(e.id?" (#"+e.id+")":"")))},this),Array.forEach(this._xold.attributes,function(t){this._xnew.hasAttribute(t.name)||("class"===t.name?this._classlist(e,this._xold,""):this._del(e,t.name,null),this._summary.push("removed @"+t.name+(e.id?" (#"+e.id+")":"")))},this)},_set:function(e,t,n){var i=e.spirit;if(i)i.att.set(t,n);else switch(e.setAttribute(t,n),t){case"checked":e.checked||(e.checked=!0);break;case"value":e.value!==n&&(e.value=String(n))}},_del:function(e,t){var n=e.spirit;if(n)n.att.del(t);else switch(t){case"checked":e.checked=!1;break;default:e.removeAttribute(t)}},_classlist:function(t,n,i){var r=i.split(" "),o=n.className.split(" ");o.forEach(function(n){n&&-1===r.indexOf(n)&&e.remove(t,n)}),r.forEach(function(n){n&&-1===o.indexOf(n)&&e.add(t,n)})},_report:function(){var e=this._summary.join(", "),t='edbml.AttsUpdate "#'+this.id+'" '+e;edbml.Update.prototype._report.call(this,t)}})}(gui.CSSPlugin),edbml.HardUpdate=edbml.Update.extend({type:edbml.Update.TYPE_HARD,xelement:null,onconstruct:function(e,t){edbml.Update.prototype.onconstruct.call(this),this.id=e,this.xelement=t},update:function(){edbml.Update.prototype.update.call(this);var e=this.element();e&&this._beforeUpdate(e)&&(gui.DOMPlugin.html(e,this.xelement.innerHTML),this._afterUpdate(e),this._report())},dispose:function(){edbml.Update.prototype.dispose.call(this),delete this.xelement},_report:function(){var e="edbml.HardUpdate #"+this.id;edbml.Update.prototype._report.call(this,e)}}),edbml.SoftUpdate=edbml.Update.extend({xelement:null,type:null,dispose:function(){edbml.Update.prototype.dispose.call(this),delete this.xelement},_import:function(e){var t=document.createElement(e.nodeName);return t.innerHTML=this.xelement.outerHTML,t.firstChild}}),edbml.InsertUpdate=edbml.SoftUpdate.extend({type:edbml.Update.TYPE_INSERT,xelement:null,onconstruct:function(e,t){this.id=e,this.xelement=t},update:function(){var e,t,n=this.element();n&&(e=n.parentNode,t=this._import(e),this._beforeUpdate(e)&&(e.insertBefore(t,n),this._afterUpdate(t),this._report()))},_report:function(){var e="edbml.InsertUpdate #"+this.xelement.getAttribute("id");edbml.SoftUpdate.prototype._report.call(this,e)}}),edbml.AppendUpdate=edbml.SoftUpdate.extend({type:edbml.Update.TYPE_APPEND,onconstruct:function(e,t){this.id=e,this.xelement=t},update:function(){var e,t=this.element();t&&(e=this._import(t),this._beforeUpdate(t)&&(t.appendChild(e),this._afterUpdate(e),this._report()))},_report:function(){var e="edbml.AppendUpdate #"+this.xelement.getAttribute("id");edbml.SoftUpdate.prototype._report.call(this,e)}}),edbml.RemoveUpdate=edbml.SoftUpdate.extend({type:edbml.Update.TYPE_REMOVE,onconstruct:function(e){this.id=e},update:function(){var e,t=this.element();t&&(e=t.parentNode,this._beforeUpdate(t)&&(e.removeChild(t),this._afterUpdate(e),this._report()))},_report:function(){var e="edbml.RemoveUpdate #"+this.id;edbml.SoftUpdate.prototype._report.call(this,e)}}),edbml.FunctionUpdate=edbml.Update.extend({type:edbml.Update.TYPE_FUNCTION,onconstruct:function(e,t){edbml.Update.prototype.onconstruct.call(this),this.id=e,this._map=t||null},update:function(){var e=0,t=this.element();this._map?(e=edbml.FunctionUpdate._remap(t,this._map))&&this._report("remapped "+e+" keys"):(e=edbml.FunctionUpdate._revoke(t))&&this._report("revoked "+e+" keys")},_report:function(e){var t="edbml.FunctionUpdate "+e+" ("+this.$instanceid+")";edbml.Update.prototype._report.call(this,t)}},{_revoke:function(e){var t,n,i=0;return this._getatts(e).forEach(function(e){t=e[1],n=gui.KeyMaster.extractKey(t.value),n&&n.forEach(function(e){edbml.$revoke(e),i++})}),i},_remap:function(e,t){var n,i,r,o=0;return Object.keys(t).length&&this._getatts(e).forEach(function(e){var s=e[0],u=e[1];(n=gui.KeyMaster.extractKey(u.value))&&n.forEach(function(e){(i=t[e])&&(r=u.value.replace(e,i),s.setAttribute(u.name,r),edbml.$revoke(e),o++)})}),o},_getatts:function(e){var t=[];return new gui.Crawler("edbml-crawler-functionupdate").descend(e,{handleElement:function(n){return n!==e&&(Array.forEach(n.attributes,function(e){e.value.includes("edbml.$run")&&t.push([n,e])}),n.spirit&&n.spirit.script.loaded)?gui.Crawler.SKIP_CHILDREN:void 0}}),t}}),edbml.UpdateCollector=gui.Class.create(Object.prototype,{onconstruct:function(){this._updates=[],this._hardupdates={}},collect:function(e,t){return this._updates.push(e),e.type===edbml.Update.TYPE_HARD?this._hardupdates[e.id]=!0:e.ids=t||{},this},hardupdates:function(e){return this._hardupdates[e]?!0:!1},eachRelevant:function(e){this._updates.filter(function(e){return e.type===edbml.Update.TYPE_HARD||Object.keys(e.ids).every(function(e){return!this._hardupdates[e]},this)},this).forEach(function(t){e(t)})},dispose:function(){this._hardupdates=null,this._updates=null},_updates:null,_hardupdates:null}),edbml.UpdateAssistant={parse:function(e,t,n){n=document.createElement(n.localName),n.innerHTML=e,n.id=t,Array.forEach(n.querySelectorAll("option"),function(e){switch(e.getAttribute("selected")){case"true":e.setAttribute("selected","selected");break;case"false":e.removeAttribute("selected")}});var i="input[type=checkbox],input[type=radio]";return Array.forEach(n.querySelectorAll(i),function(e){switch(e.getAttribute("checked")){case"true":e.setAttribute("checked","checked");break;case"false":e.removeAttribute("checked")}}),n},order:function(e){var t={};return Array.forEach(e,function(e,n){e.nodeType===Node.ELEMENT_NODE&&(t[e.id]=n)},this),t},index:function(e){var t=Object.create(null);return Array.forEach(e,function(e,n){e.nodeType===Node.ELEMENT_NODE&&(t[e.id]=e)},this),t}},edbml.UpdateManager=function(e,t,n,i,r,o){return gui.Class.create(Object.prototype,{onconstruct:function(e){this._keyid=e.dom.id()||e.$instanceid,this._spirit=e},update:function(e){this._spirit.life.destructed||(this._updates=new edbml.UpdateCollector,this._functions={},this._olddom?(this._next(e),this._updates.collect(new o(this._keyid,this._functions))):this._first(e),
this._updates.eachRelevant(function(e){e.update(),e.dispose()}),this._updates&&this._updates.dispose(),this._updates=null)},_keyid:null,_doc:null,_spirit:null,_olddom:null,_nedwdom:null,_updates:null,_assistant:edbml.UpdateAssistant,_first:function(t){this._olddom=this._parse(t),this._updates.collect(new e(this._keyid,this._olddom))},_next:function(e){this._newdom=this._parse(e),this._crawl(this._newdom,this._olddom,this._newdom,this._keyid,{}),this._olddom=this._newdom},_parse:function(e){return this._assistant.parse(e,this._keyid,this._spirit.element)},_crawl:function(e,t,n,i,r){for(var o=!0;e&&t&&!this._updates.hardupdates(i);){switch(e.nodeType){case Node.TEXT_NODE:o=this._check(e,t,n,i,r);break;case Node.ELEMENT_NODE:o=this._scan(e,t,n,i,r)}e=e.nextSibling,t=t.nextSibling}return o},_scan:function(e,t,n,i,r){var o=!0,s=t.id;return(o=this._check(e,t,n,i,r))&&(s&&(r=gui.Object.copy(r),n=e,r[s]=!0,i=s),o=this._crawl(e.firstChild,t.firstChild,n,i,r)),o},_check:function(t,n,i,r,s){var u=!0,c=!1,a=!1;if(t&&!n||!t&&n)u=!1;else if(u=t.nodeType===n.nodeType)switch(n.nodeType){case Node.TEXT_NODE:t.data!==n.data&&(u=!1);break;case Node.ELEMENT_NODE:(u=this._familiar(t,n))&&(u=this._checkatts(t,n,s))&&(this._maybesoft(t,n)?(this._confirmsoft(t,n)&&(this._updatesoft(t,n,s),c=!0),u=!1):"textarea"!==n.localName&&(u=t.childNodes.length===n.childNodes.length,!u&&n.id&&(i=t,r=n.id)))}return u||c||a||(this._updates.collect(new o(r)),this._updates.collect(new e(r,i))),u},_familiar:function(e,t){return["namespaceURI","localName"].every(function(n){return e[n]===t[n]})},_checkatts:function(e,n,i){var r=!0,o=null;if(this._attschanged(e.attributes,n.attributes,i)){var s=e.id,u=n.id;s&&s===u?(o=new t(u,e,n),this._updates.collect(o,i)):r=!1}return r},_attschanged:function(e,t,n){var i=e.length!==t.length;return i||(i=!Array.every(e,function(e){var n=t.getNamedItem(e.name);return n&&(n.value===e.value||this._onlyedbmlchange(e.value,n.value))},this)),i},_onlyedbmlchange:function(e,t){if([e,t].every(function(e){return e.includes("edbml.$")})){var n,i=gui.KeyMaster.extractKey(e),r=gui.KeyMaster.extractKey(t);if(i&&r)return r.forEach(function(r,o){n=i[o],e=e.replace(n,""),t=t.replace(r,""),this._functions[r]=n},this),e===t}return!1},_maybesoft:function(e,t){return e&&t?e.id&&e.id===t.id&&this._maybesoft(e)&&this._maybesoft(t):Array.every(e.childNodes,function(e){var t=!0;switch(e.nodeType){case Node.TEXT_NODE:t=""===e.data.trim();break;case Node.ELEMENT_NODE:t=""!==e.id}return t},this)},_confirmsoft:function(e,t){var n=!0,i=null,r=this._assistant.order(t.childNodes);return Array.every(e.childNodes,function(e,t){if(e.nodeType===Node.ELEMENT_NODE){var o=e.id;r.hasOwnProperty(o)&&r.hasOwnProperty(i)&&(n=r[o]>r[i]),i=o}return n},this)},_updatesoft:function(e,t,s){for(var u=[],c=this._assistant.index(e.childNodes),a=this._assistant.index(t.childNodes),d=e.lastElementChild,l=t.id,p=null,h=null;d;)h=d.id,a[h]?p=h:p?u.push(new n(p,d)):u.push(new r(l,d)),d=d.previousElementSibling;Object.keys(a).forEach(function(e){if(c[e]){var t=c[e],n=a[e];this._scan(t,n,t,e,s)}else u.push(new i(e)),u.push(new o(e))},this),u.reverse().forEach(function(e){this._updates.collect(e,s)},this)}})}(edbml.HardUpdate,edbml.AttsUpdate,edbml.InsertUpdate,edbml.RemoveUpdate,edbml.AppendUpdate,edbml.FunctionUpdate),edbml.ScriptPlugin=function(e,t){return gui.Plugin.extend({loaded:!1,ran:!1,debug:!1,onconstruct:function(){gui.Plugin.prototype.onconstruct.call(this),this._oldfokkers={},this._newfokkers={}},ondestruct:function(){gui.Plugin.prototype.ondestruct.call(this),this.loaded&&(gui.Tick.cancelFrame(this._frameindex),this.spirit.life.remove(gui.LIFE_ENTER,this),gui.Broadcast.remove(edb.BROADCAST_ACCESS,this),this.$input&&(this.$input.ondestruct(),this.$input.$ondestruct()))},load:e(t("function|string")(function(e){e=gui.Type.isFunction(e)?e:gui.Object.lookup(e),e&&(this.loaded=!0,this._script=e,this._updater=new edbml.UpdateManager(this.spirit),this._process(e.$instructions),this.$input||this.run())})),oninput:function(e){this.loaded?e.revoked?this.write(""):(!this.$input||this.$input.done)&&this._schedule():this._notloaded()},run:function(){gui.Tick.cancelFrame(this._frameindex),this.loaded?!this.$input||this.$input.done?this.spirit.life.entered?this.write(this._run.apply(this,arguments)):(this.spirit.life.add(gui.LIFE_ENTER,this),this._arguments=arguments):this._notready():this._notloaded()},write:function(e){var t=this._html!==e,n=this._focusedfield();t&&(this._html=e,this._updater.update(e),n&&this._restorefocus(n)),this._status(this.spirit),this.ran=!0},input:function(){var e,t;if(t=this.$input){if(this.loaded)return e=gui.Array.make(arguments).map(function(e){return t.$oninput(new edb.Input(e.constructor,e)),e}),e.length>1?e:e[0];this._notloaded()}else this._noinputexpected()},revoke:function(){gui.Array.make(arguments).forEach(function(e){var t=edb.Type.is(e)?e.constructor:e;this.$input.$oninput(new edb.Input(t,null))},this)},onbroadcast:function(e){var t=this._newfokkers;switch(e.type){case edb.BROADCAST_ACCESS:var n=e.data[0],i=e.data[1],r=n.$instanceid;t[r]||(t[r]={object:n},i&&(t[r].properties={})),i&&(t[r].properties[i]=!0)}},onchange:function(e){e.some(function(e){var t=e.object.$instanceid,n=e.object.$classname,i=e.name;if(!edbml.$rendering||!edbml.$rendering[t]){var r=this._oldfokkers[t].properties;try{if(!i||r[i])return!0}catch(o){}return!1}console.error("Don't update \""+i+'" of the '+n+" while rendering, it will cause the rendering to run in an endless loop. ")},this)&&this._schedule()},onlife:function(e){e.type===gui.LIFE_ENTER&&(this.spirit.life.rendered||this.run.apply(this,this._arguments||[]),this.spirit.life.remove(e.type,this),this._arguments=null)},$input:null,_src:null,_script:null,_updater:null,_oldfokkers:null,_arguments:null,_html:null,_frameindex:-1,_process:function(e){if(e){var t=[],n=[];e.reduce(function(e,i){var r=Object.keys(i),o=r[0],s=i[o];if("input"===o){var u=s.required===!1?t:n;return u.push(gui.Object.lookup(s.type)),!0}return e},!1)&&(this.$input=new edb.InputPlugin,this.$input.connect(n,this,!0),this.$input.connect(t,this,!1))}},_start:function(){edbml.$rendering=this._oldfokkers||{},gui.Broadcast.add(edb.BROADCAST_ACCESS,this),edb.$accessaware=!0,this._newfokkers={}},_stop:function(){var e=this._oldfokkers,t=this._newfokkers;edbml.$rendering=null,gui.Broadcast.remove(edb.BROADCAST_ACCESS,this),edb.$accessaware=!1,Object.keys(e).forEach(function(n){t[n]||(e[n].object.removeObserver(this),delete e[n])},this),Object.keys(t).forEach(function(n){var i=e[n],r=t[n];i?r.properties&&(i.properties=r.properties):(e[n]=t[n],e[n].object.addObserver(this),delete t[n])},this),this._newfokkers=null},_schedule:function(){gui.Tick.cancelFrame(this._frameindex);var e=this.spirit,t=this.$input,n=function(){e.life.destructed||t&&!t.done||this.run()}.bind(this);e.life.entered?e.life.rendered?this._frameindex=gui.Tick.nextFrame(n):n():e.life.add(gui.LIFE_ENTER,this)},_status:function(e){e.life.rendered=!0,e.onrender({first:!this.ran}),e.life.dispatch(gui.LIFE_RENDER)},_run:function(){this._start();var e=this._script.apply(this.spirit,arguments);return this._stop(),e},_notready:function(){var e,t=this.$input;(t._watches||[]).forEach(function(n){(e=edb.get(n))&&t.$oninput(new edb.Input(n,e))},this)},_notloaded:function(){console.error("Spiritual EDBML: No script loaded for "+this.spirit)},_noinputexpected:function(){console.error("Spiritual EDBML: No input expected for "+this.spirit)},_focusedfield:function(){var e;try{e=document.activeElement}catch(t){e=null}return e&&gui.DOMPlugin.contains(this.spirit.element,e)?this._focusselector(e):null},_focusselector:function(e){function t(e){if(e.id)try{return gui.DOMPlugin.q(e.parentNode,e.id),!0}catch(t){}return!1}for(var n=-1,i=[];e&&e.nodeType===Node.ELEMENT_NODE;)t(e)?(i.push("#"+e.id),e=null):"body"===e.localName?(i.push("body"),e=null):(n=gui.DOMPlugin.ordinal(e)+1,i.push(">"+e.localName+":nth-child("+n+")"),e=e.parentNode);return i.reverse().join("")},_restorefocus:function(e){var t,n="textarea, input:not([type=checkbox]):not([type=radio])",i=gui.DOMPlugin.qdoc(e);try{t=document.activeElement}catch(r){t=null}i&&i!==t&&(i.focus(),gui.CSSPlugin.matches(i,n)&&i.setSelectionRange(i.value.length,i.value.length))}})}(gui.Combo.chained,gui.Arguments.confirmed),edbml.ScriptSpirit=gui.Spirit.extend({scriptid:null,onconfigure:function(){if(gui.Spirit.prototype.onconfigure.call(this),this.dom.embedded()){var e,t=this.dom.parent(gui.Spirit);t&&(e=this.scriptid)&&t.script.load(gui.Object.lookup(e))}}}),edbml.Security=function(e,t,n){return{$safetext:function(t){return e.firstChild.data=String(t),e.innerHTML},$safeattr:function(e){return String(e).replace(n,function(e){return t[e]})}}}(function(){var e=document.createElement("div"),t=document.createTextNode("");return e.appendChild(t),e}(),function(){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}}(),/[&<>'"]/g),gui.module("edbml@wunderbyte.com",{mixin:{src:function(e){if(gui.Type.isString(e)){var t=gui.Object.lookup(e);if(!t)throw new Error(this+' could not locate "'+e+'"');e=t}if(!gui.Type.isFunction(e))throw new TypeError(this+" could not load script");this.script.load(e)},onrender:function(e){},onchange:function(e){},oninput:function(e){},$oninput:function(e){this.script.input.match(e)}},plugin:{script:edbml.ScriptPlugin},channel:[[".gui-script","edbml.ScriptSpirit"]],oncontextinitialize:function(){var t,n=gui.Spirit.prototype;if(gui.Function.decorateAfter(n,"onconfigure",function(){edbml.bootload&&!this.script.loaded&&(t=gui.Object.lookup(this.$classname+".edbml"),gui.Type.isFunction(t)&&this.script.load(t))}),!e.event)try{e.event=null}catch(i){}}})}(self);
//# sourceMappingURL=spiritual-edb.js.map